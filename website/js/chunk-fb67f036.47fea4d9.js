(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fb67f036"],{7174:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-tree-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",treeCheckable:e.mulSelect,treeData:e.treeData,dropdownStyle:{maxHeight:"400px",overflow:"auto"},placeholder:"请选择",allowClear:"",disabled:e.disabled,treeDefaultExpandAll:e.treeDefaultExpandAll,treeDefaultExpandedKeys:e.defaultExpandedKeys},on:{change:e.change},model:{value:e.selectDep,callback:function(t){e.selectDep=t},expression:"selectDep"}})},r=[],s=(a("4160"),a("c975"),a("a9e3"),a("159b"),function e(t){for(var a=0;a<t.length;a++)t[a].value=t[a].key,t[a].status&&(t[a].disabled=!0),t[a].children.length>0&&e(t[a].children,t[a].key,t[a].title);return t}),l={name:"depTreeSelect",data:function(){return{treeData:[],selectDep:"",defaultExpandedKeys:[]}},props:{mulSelect:{type:Boolean,default:!1,required:!1},disabledList:{type:Array,default:function(){return[]},required:!1},selectDepData:{type:[Number,String,Array],default:null,required:!1},disabled:{type:Boolean,default:!1,required:!1},treeDefaultExpandAll:{type:Boolean,default:!1}},watch:{selectDepData:{handler:function(e,t){e&&(this.selectDep=e,this.defaultExpandedKeys.push(e))},immediate:!0}},methods:{change:function(e){this.$emit("getValue",e)},clear:function(){}},created:function(){var e=this,t=this.$store.state.SysDepartment.treeData;t=s(t),t.length>0&&t.forEach((function(t){t.children&&t.children.length>0&&e.defaultExpandedKeys.push(t.children[0].key)})),this.treeData=t}},i=l,o=a("2877"),u=Object(o["a"])(i,n,r,!1,null,null,null);t["a"]=u.exports},aa58:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"用户编辑"},on:{ok:e.submit,close:e.close}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",e._b({attrs:{label:"用户编号"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userCode",{initialValue:e.userInfo.username,rules:[{required:!1,message:"Please input your note!"}]}],expression:"[\n          'userCode',\n          {\n            initialValue: userInfo.username,\n            rules: [{ required: false, message: 'Please input your note!' }],\n          },\n        ]"}]})],1),a("a-form-item",e._b({attrs:{label:"用户姓名","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.userInfo.name,rules:[{required:!0,message:"请输入用户姓名"}]}],expression:"[\n          'name',\n          {\n            initialValue: userInfo.name,\n            rules: [\n              {\n                required: true,\n                message: '请输入用户姓名',\n              },\n            ],\n          },\n        ]"}]})],1),a("a-form-item",e._b({attrs:{label:"联系方式","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{initialValue:e.userInfo.phone,rules:[{required:!0,message:"请输入用户联系方式"}]}],expression:"[\n          'phone',\n          {\n            initialValue: userInfo.phone,\n            rules: [\n              {\n                required: true,\n                message: '请输入用户联系方式',\n              },\n            ],\n          },\n        ]"}]})],1),a("a-form-item",e._b({attrs:{label:"主属部门","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("DepTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["mainDeptId",{rules:[{required:!0,message:"请输入用户主属部门"}]}],expression:"[\n          'mainDeptId',\n          {\n            rules: [\n              {\n                required: true,\n                message: '请输入用户主属部门',\n              },\n            ],\n          },\n        ]"}],ref:"mainDep",attrs:{disabledList:e.dep},on:{getValue:e.getMainDep}})],1),a("a-form-item",e._b({attrs:{label:"附属部门","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("DepMulTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptIds",{rules:[{required:!1}]}],expression:"[\n          'deptIds',\n          {\n            rules: [\n              {\n                required: false,\n              },\n            ],\n          },\n        ]"}],ref:"subDep",attrs:{mulSelect:!0},on:{getValue:e.getDep}})],1),a("a-form-item",e._b({attrs:{label:"职位","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jobName",{initialValue:e.userInfo.jobName,rules:[{required:!1,message:"请输入用户联系方式"},{validator:e.phoneValidata}]}],expression:"[\n          'jobName',\n          {\n            initialValue: userInfo.jobName,\n            rules: [\n              {\n                required: false,\n                message: '请输入用户联系方式',\n              },\n              {\n                validator: phoneValidata,\n              },\n            ],\n          },\n        ]"}]})],1)],1)],1)},r=[],s=(a("4d63"),a("ac1f"),a("25f0"),a("5530")),l=a("2f62"),i=a("7174"),o=a("e4c7"),u=a("86da"),d={name:"Department",components:{Modal:u["a"],DepTreeSelect:i["a"],DepMulTreeSelect:o["a"]},data:function(){return{userId:"",userInfo:{},mapDep:"",dep:[],form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},tailFormItemLayout:{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}}}},props:{},watch:{},created:function(){},mounted:function(){},computed:{},methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])({onGetDetail:"SysUser/onDetail",onUpdate:"SysUser/onUpdate"})),{},{getDetail:function(){var e=this;this.onGetDetail(this.userId).then((function(t){e.userInfo=t,e.mainDep=t.mainDeptId,e.dep=t.deptIds,e.$refs.mainDep.selectDep=+t.mainDeptId,e.$refs.subDep.selectDep=t.deptIds}))},getMainDep:function(e){this.mainDep=e},getDep:function(e){this.dep=e},phoneValidata:function(e,t,a){var n=new RegExp(/^[0-9]+$/);t&&n.test(t)?a("当前联系方式不符合规范，请重新填写!"):a()},close:function(){this.form.resetFields(),this.$refs.modal.visible=!1},show:function(){this.getDetail(),this.$refs.modal.show()},submit:function(){var e=this,t=this,a=this.form.getFieldsValue();a.mainDeptId=this.mainDep;for(var n=this.dep,r=[],s=0;s<n.length;s++)""!=n[s]&&void 0!=n&&r.push(+n[s]);a.deptIds=r,this.form.setFieldsValue(a),this.form.validateFieldsAndScroll((function(a,n){a?e.pop.loading=!1:(n.userId=t.userId,t.onUpdate(n).then((function(e){t.form.resetFields(),t.$message.success("用户修改成功"),t.$emit("updateUserSuccess"),t.close()})))}))}})},c=d,p=a("2877"),f=Object(p["a"])(c,n,r,!1,null,null,null);t["default"]=f.exports},e4c7:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-tree-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",treeCheckable:!0,treeData:e.treeData,dropdownStyle:{maxHeight:"400px",overflow:"auto"},placeholder:"请选择",allowClear:"",disabled:e.disabled,treeDefaultExpandAll:e.treeDefaultExpandAll,treeDefaultExpandedKeys:e.defaultExpandedKeys},on:{change:e.change},model:{value:e.selectDep,callback:function(t){e.selectDep=t},expression:"selectDep"}})},r=[],s=(a("4160"),a("c975"),a("159b"),function e(t){for(var a=0;a<t.length;a++)t[a].value=t[a].key,t[a].children.length>0&&e(t[a].children,t[a].key,t[a].title);return t}),l={name:"depTreeSelect",data:function(){return{treeData:[],selectDep:[],defaultExpandedKeys:[]}},props:{disabledList:{type:Array,default:function(){return[]},required:!1},disabled:{type:Boolean,default:!1,required:!1},treeDefaultExpandAll:{type:Boolean,default:!1}},watch:{selectDep:function(e){var t=this.$store.state.SysDepartment.treeData;t=s(t),t.length>0&&t.forEach((function(e){return e.disabled=!0})),this.treeData=t,0===e&&(this.selectDep=t[0].key)}},methods:{change:function(e){this.$emit("getValue",e)},clear:function(){this.selectDep=null}},created:function(){var e=this,t=this.$store.state.SysDepartment.treeData;console.log(t),t=s(t),t.length>0&&t.forEach((function(t){t.children&&t.children.length>0&&(t.disabled=!0,e.defaultExpandedKeys.push(t.children[0].key))})),this.treeData=t}},i=l,o=a("2877"),u=Object(o["a"])(i,n,r,!1,null,null,null);t["a"]=u.exports}}]);