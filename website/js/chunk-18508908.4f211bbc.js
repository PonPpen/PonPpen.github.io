(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18508908"],{4869:function(t,e,n){"use strict";var r=n("724f"),a=n.n(r);a.a},"724f":function(t,e,n){},a880:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("PageView",[n("SplitLayout",[n("a-spin",{attrs:{tip:"努力加载中...",spinning:!t.UEditorBool}},[n("div",{staticClass:"SplitLayout",attrs:{width:"20"}},[n("div",{staticClass:"leftLayout"},[n("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入搜索内容回车搜索"},on:{search:t.onSearch}}),t.menu.length>0?n("a-collapse",{attrs:{"default-active-key":"0","expand-icon-position":"right"}},t._l(t.menu,(function(e,r){return n("a-collapse-panel",{key:r,attrs:{header:e.businessName}},t._l(e.data,(function(e,r){return n("div",{key:r,attrs:{title:"点击可在光标处绑定该值("+e.value+")"},on:{click:function(n){return t.clickSetContent(e)}}},[t._v(" "+t._s(e.name)+" ")])})),0)})),1):n("div",{staticStyle:{"text-align":"center"}},[t._v(" \\ (•◡•) / 暂无数据 ")])],1),n("div",{staticClass:"rightLayout"},[n("a-form-model",{ref:"ruleForm",attrs:{layout:"inline",model:t.form,rules:t.rules}},[n("a-form-model-item",{attrs:{label:"模板名称：",prop:"name"}},[n("a-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入模板名称","allow-clear":""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("a-form-model-item",{attrs:{label:"模板类型：",prop:"type"}},[n("a-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择模板类型"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[n("a-select-option",{attrs:{value:"1"}},[t._v("消息模板")]),n("a-select-option",{attrs:{value:"2"}},[t._v("文档模板")])],1)],1),n("a-form-model-item",{attrs:{label:"适用范围：",prop:"rangeInfo"}},[n("ScopeApplication",{ref:"SelectIndex",attrs:{allCheckedList:t.rangeInfo,width:200},on:{getRangeInfo:t.getRangeInfo}})],1),n("a-form-model-item",[n("a-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),n("a-button",{attrs:{type:"primary"},on:{click:t.preview}},[t._v("预览")])],1)],1),1==t.form.type&&t.UEditorBool?n("a-textarea",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{placeholder:"请填写消息内容",id:"editor",rows:14},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}):t._e(),2==t.form.type&&t.UEditorBool?n("UEditor",{ref:"UEditor",staticClass:"UEditor",attrs:{ToolbarsType:t.toolbarsType,content:t.form.content,menuObj:t.menuObj}}):t._e()],1)])]),n("Modal",{ref:"modal",attrs:{title:"",footer:!1,width:1e3}},[n("div",{attrs:{id:"preview"}},[n("div",{domProps:{innerHTML:t._s(t.content)}})])])],1)],1)},a=[],o=(n("4160"),n("c975"),n("b0c0"),n("498a"),n("159b"),n("96cf"),n("1da1")),i=n("f45a"),s=n("86da"),c=n("e96b"),u=n("ea07"),d=n("cc33"),l={components:{UEditor:i["a"],Modal:s["a"],ScopeApplication:c["a"]},props:["id"],data:function(){return{toolbarsType:2,form:{type:"2"},menu:[],menuList:[],content:"",menuObj:{},rangeInfo:[],UEditorBool:!0,rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],type:[{required:!0,message:"请选择模板类型",trigger:"blur"}],rangeInfo:[{required:!1,message:"请选择使用范围",trigger:"blur"}]}}},created:function(){this.id&&(this.UEditorBool=!1,this.details()),this.getDocBusinessField()},mounted:function(){},methods:{onSearch:function(t){var e=this;if(this.menu=[],t&&""!=t.trim()){var n=function(n){var r=e.menuList[n];if(r.businessName.indexOf(t)>-1)e.menu.push(r);else if(r.data.length>0){var a={};r.data.forEach((function(e,n){e.name.indexOf(t)>-1&&(a=Object.assign({},r),a.data=[],a.data.push(e))})),a.data&&e.menu.push(a)}};for(var r in this.menuList)n(r)}else this.menu=this.menuList},save:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return console.log("error submit!!"),!1;t.id?t.update():t.create()}))},create:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 2==t.form.type&&(n=t.$refs.UEditor.$refs.VueUeditor.value,t.form.content=n),t.form.tenantId=Object(d["f"])().tenantId,e.next=4,Object(u["b"])(t.form);case 4:r=e.sent,200===r.status&&(t.$message.success("创建成功"),t.$router.go(-1));case 6:case"end":return e.stop()}}),e)})))()},update:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 2==t.form.type&&(n=t.$refs.UEditor.$refs.VueUeditor.value,t.form.content=n),e.next=3,Object(u["g"])(t.form);case 3:r=e.sent,200===r.status&&(t.$message.success("保存成功"),t.$router.go(-1));case 5:case"end":return e.stop()}}),e)})))()},details:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["c"])(t.id);case 2:n=e.sent,200===n.status&&(t.form=n.data,t.UEditorBool=!0,t.rangeInfo=n.data.rangeInfo);case 4:case"end":return e.stop()}}),e)})))()},getDocBusinessField:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["a"])();case 2:n=e.sent,200===n.status&&(t.menuList=n.data,t.menu=n.data);case 4:case"end":return e.stop()}}),e)})))()},preview:function(){if(1==this.form.type)this.content=this.form.content,this.$refs.modal.visible=!0;else if(2==this.form.type){var t=this.$refs.UEditor.$refs.VueUeditor.value;this.$refs.modal.visible=!0,this.content=t}},makeActive:function(t){var e=document.getElementById("editor"),n=e.selectionStart,r=e.selectionEnd;if(void 0!==n&&void 0!==r){var a=e.value,o=a.substring(0,n)+t+a.substring(r);e.value=o,e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length,this.form.content=o}},clickSetContent:function(t){this.menuObj=t;var e="{{"+t.value+"}}",n="<span name="+t.value+' style="display: inline-block;vertical-align: bottom;border-bottom: 1px #8e8e8e solid;min-width: 100px;text-align: center;text-indent: 0; padding: 0 14px;">'+e+"</span>";1==this.form.type?this.makeActive(e):2==this.form.type&&this.$refs.UEditor.setContent(n)},start:function(t){this.clickSetContent(this.menuObj)},end:function(t){this.clickSetContent(this.menuObj)},getRangeInfo:function(t){this.form.rangeInfo=t}}},f=l,m=(n("4869"),n("2877")),p=Object(m["a"])(f,r,a,!1,null,"2f74c479",null);e["default"]=p.exports},ea07:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"e",(function(){return l}));var r=n("a27e"),a={docCreate:"/doc-service/doc/create",docDetail:"/doc-service/doc/detail",docIsDefault:"/doc-service/doc/isDefault",docPage:"/doc-service/doc/page",docUpdate:"/doc-service/doc/update",docBusinessField:"/doc-service/doc/businessField",docList:"/doc-service/doc/list"};function o(t){return Object(r["a"])({url:a.docCreate,method:"POST",data:t})}function i(t){return Object(r["a"])({url:a.docDetail+"/".concat(t),method:"GET"})}function s(t){return Object(r["a"])({url:a.docIsDefault,method:"PUT",data:t})}function c(t){return Object(r["a"])({url:a.docPage,method:"POST",data:t})}function u(t){return Object(r["a"])({url:a.docUpdate,method:"PUT",data:t})}function d(t){return Object(r["a"])({url:a.docBusinessField,method:"GET"})}function l(t){return Object(r["a"])({url:a.docList,method:"POST",data:t})}}}]);