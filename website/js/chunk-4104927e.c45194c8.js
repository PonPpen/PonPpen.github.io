(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4104927e"],{1586:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("SplitLayout",[a("a-spin",{attrs:{spinning:!1}},[a("div",{staticClass:"container"},[a("div",{staticClass:"top",staticStyle:{margin:"0 0 25px 30px"},attrs:{slot:"top"},slot:"top"},[e._v(" 人员基本信息 ")]),a("a-form-model",{ref:"formModal",staticStyle:{"margin-left":"30px"},attrs:{model:e.form,rules:e.rules,labelCol:{span:24},wrapperCol:{span:16}}},[a("a-form-model-item",[a("UploadAvatar",{attrs:{avatarType:2,imgURL:e.form.avatar,disabled:e.disabledObj.avatar},on:{getAvatar:e.getAvatar}})],1),a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{staticClass:"btn",staticStyle:{position:"relative"},attrs:{prop:"identityCard",label:"身份证号"}},[a("a-input",{attrs:{disabled:e.isEdit},model:{value:e.form.identityCard,callback:function(t){e.$set(e.form,"identityCard",t)},expression:"form.identityCard"}}),a("a-spin",{staticStyle:{position:"absolute",right:"-85px",top:"-10px"},attrs:{spinning:e.btnLoading}},[a("a-button",{attrs:{disabled:e.isEdit,type:"primary"},on:{click:e.get_info}},[e._v("查询")])],1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"realName",label:"姓名"}},[a("a-input",{attrs:{disabled:e.disabledObj.realName},model:{value:e.form.realName,callback:function(t){e.$set(e.form,"realName",t)},expression:"form.realName"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"nickName",label:"别名/绰号"}},[a("a-input",{attrs:{disabled:e.disabledObj.nickName},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"phone",label:"电话号码"}},[a("a-input",{attrs:{disabled:e.disabledObj.phone},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"sex",label:"性别"}},[a("a-select",{attrs:{disabled:e.disabledObj.sex},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[a("a-select-option",{attrs:{value:1}},[e._v("男")]),a("a-select-option",{attrs:{value:2}},[e._v("女")])],1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"nation",label:"民族"}},[a("a-select",{staticStyle:{width:"100%"},attrs:{disabled:e.disabledObj.nation},model:{value:e.form.nation,callback:function(t){e.$set(e.form,"nation",t)},expression:"form.nation"}},e._l(e.nationData,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"birthday",label:"出生日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:e.disabledObj.birthday,format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"请选择","show-time":"",type:"date"},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"marriage",label:"婚姻状况"}},[a("a-select",{attrs:{disabled:e.disabledObj.marriage},model:{value:e.form.marriage,callback:function(t){e.$set(e.form,"marriage",t)},expression:"form.marriage"}},[a("a-select-option",{attrs:{value:1}},[e._v("未婚")]),a("a-select-option",{attrs:{value:2}},[e._v("已婚")]),a("a-select-option",{attrs:{value:3}},[e._v("离婚")]),a("a-select-option",{attrs:{value:4}},[e._v("丧偶")])],1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"education",label:"文化程度"}},[a("a-select",{attrs:{disabled:e.disabledObj.education},model:{value:e.form.education,callback:function(t){e.$set(e.form,"education",t)},expression:"form.education"}},[a("a-select-option",{attrs:{value:1}},[e._v("小学")]),a("a-select-option",{attrs:{value:2}},[e._v("初中")]),a("a-select-option",{attrs:{value:3}},[e._v("高中")]),a("a-select-option",{attrs:{value:4}},[e._v("中专")]),a("a-select-option",{attrs:{value:5}},[e._v("大专")]),a("a-select-option",{attrs:{value:6}},[e._v("本科")]),a("a-select-option",{attrs:{value:7}},[e._v("本科以上")]),a("a-select-option",{attrs:{value:8}},[e._v("文盲或半文盲")])],1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"background",label:"职业"}},[a("a-input",{attrs:{disabled:e.disabledObj.background},model:{value:e.form.background,callback:function(t){e.$set(e.form,"background",t)},expression:"form.background"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"householdTown",label:"户籍所在地"}},[a("a-input",{attrs:{disabled:e.disabledObj.householdTown},model:{value:e.form.householdTown,callback:function(t){e.$set(e.form,"householdTown",t)},expression:"form.householdTown"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"householdAddress",label:"户籍详细地址"}},[a("a-input",{attrs:{disabled:e.disabledObj.householdAddress},model:{value:e.form.householdAddress,callback:function(t){e.$set(e.form,"householdAddress",t)},expression:"form.householdAddress"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"currentAddress",label:"家庭详细地址"}},[a("a-input",{attrs:{disabled:e.disabledObj.currentAddress},model:{value:e.form.currentAddress,callback:function(t){e.$set(e.form,"currentAddress",t)},expression:"form.currentAddress"}})],1)],1)],1),a("div",{staticClass:"top"},[e._v(" 人员入所信息 ")]),a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"drugRehabilitationName",label:"戒毒所名称"}},[a("a-input",{attrs:{disabled:!0},model:{value:e.form.drugRehabilitationName,callback:function(t){e.$set(e.form,"drugRehabilitationName",t)},expression:"form.drugRehabilitationName"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"firstDrugTimeStr",label:"初次吸毒日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"请选择","show-time":"",type:"date"},on:{change:e.onDateChange4},model:{value:e.form.firstDrugTimeStr,callback:function(t){e.$set(e.form,"firstDrugTimeStr",t)},expression:"form.firstDrugTimeStr"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"滥用毒品类型",prop:"drugPersonTypeStr"}},[a("a-checkbox-group",{model:{value:e.form.drugPersonTypeStr,callback:function(t){e.$set(e.form,"drugPersonTypeStr",t)},expression:"form.drugPersonTypeStr"}},[a("div",{staticClass:"check_group"},[e._l(e.drug_type,(function(t){return[a("a-checkbox",{key:t.value,attrs:{value:1*t.value,checked:""}},[e._v(e._s(t.label))])]}))],2)])],1),a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"drugTreatmentTimeLimit",label:"戒毒期限"}},[a("a-select",{on:{change:e.onDateChange1},model:{value:e.form.drugTreatmentTimeLimit,callback:function(t){e.$set(e.form,"drugTreatmentTimeLimit",t)},expression:"form.drugTreatmentTimeLimit"}},[a("a-select-option",{attrs:{value:"小于一年"}},[e._v("小于一年")]),a("a-select-option",{attrs:{value:"一年"}},[e._v("一年")]),a("a-select-option",{attrs:{value:"两年"}},[e._v("两年")]),a("a-select-option",{attrs:{value:"三年"}},[e._v("三年")]),a("a-select-option",{attrs:{value:"三年以上"}},[e._v("三年以上")])],1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"drugTreatmentBeginTimeStr",label:"起始日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"请选择","show-time":"",type:"date"},on:{change:e.onDateChange1},model:{value:e.form.drugTreatmentBeginTimeStr,callback:function(t){e.$set(e.form,"drugTreatmentBeginTimeStr",t)},expression:"form.drugTreatmentBeginTimeStr"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"drugTreatmentEndTimeStr",label:"截止日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"请选择","show-time":"",type:"date",disabled:e.isDisabled},on:{change:e.onDateChange2},model:{value:e.form.drugTreatmentEndTimeStr,callback:function(t){e.$set(e.form,"drugTreatmentEndTimeStr",t)},expression:"form.drugTreatmentEndTimeStr"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"actionCause",label:"主要违法事实"}},[a("a-input",{model:{value:e.form.actionCause,callback:function(t){e.$set(e.form,"actionCause",t)},expression:"form.actionCause"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"insertTimeStr",label:"入所日期"}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",placeholder:"请选择","show-time":"",type:"date"},on:{change:e.onDateChange3},model:{value:e.form.insertTimeStr,callback:function(t){e.$set(e.form,"insertTimeStr",t)},expression:"form.insertTimeStr"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{prop:"decisionMakingOrgan",label:"决定机关"}},[a("a-input",{model:{value:e.form.decisionMakingOrgan,callback:function(t){e.$set(e.form,"decisionMakingOrgan",t)},expression:"form.decisionMakingOrgan"}})],1)],1)],1),a("a-form-model-item",[a("a-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)])],1)},i=[],s=(a("99af"),a("a15b"),a("4ec9"),a("4fad"),a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("1da1")),o=a("3835"),n=a("5530"),d=a("418e"),m=a("0867"),l=a("d8b0"),u=a("dba5"),c=a("2f62"),f=a("551c"),g=a("cf45"),p={name:"modify_abstainDetail",components:{UploadAvatar:d["a"]},data:function(){return{isEdit:!1,loading:!1,a:[1,2,3],rules:m["default"].rules,drug_type:[],drug_way:[],form:{identityCard:"",avatar:"",birthday:"",phone:"",currentAddress:"",education:"",householdAddress:"",householdTown:"",marriage:"",nation:"",nickName:"",realName:"",sex:"",background:"",drugTreatmentEndTimeStr:""},disabledObj:{},id:"",departmentId:"",level:"",btnLoading:!1,nationData:[],fileList:[],isDisabled:!1}},created:function(){var e=this;if(this.departmentId=this.$route.query.departmentId,this.level=this.$route.query.level,this.isEdit="add"!=this.$route.query.type,this.isEdit?this.rules=l["default"].rules:this.rules=m["default"].rules,this.initDisabledObj(!0),this.isEdit){var t=this.$route.query.id;this.id=t,f["a"].get_abstain_info(t).then((function(t){var a=t.insertOutPerson.drugPersonTypeStr;e.form=Object(n["a"])(Object(n["a"])(Object(n["a"])({},t.createBasePersonVO),t.insertOutPerson),{drugPersonTypeStr:a})}))}this.form.drugRehabilitationName=this.$route.query.areaName;var a=[];a.push(f["a"].get_dictionary("DRUG_TYPE")),a.push(f["a"].get_dictionary("DRUG_WAY")),Promise.all([].concat(a)).then((function(t){var a=Object(o["a"])(t,2),r=a[0],i=a[1];e.drug_type=r,e.drug_way=i})),this.initialize()},methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])({onChildDictionary:"SysDictionary/onChildDictionary"})),{},{initialize:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.onChildDictionary({parentId:"147"});case 2:e.nationData=t.sent;case 3:case"end":return t.stop()}}),t)})))()},initDisabledObj:function(e){for(var t in this.form)this.disabledObj[t]=e},onDateChange1:function(){var e=new Date(this.form.drugTreatmentBeginTimeStr);if(void 0!=this.form.drugTreatmentBeginTimeStr){var t=Object(g["b"])(this.form.drugTreatmentBeginTimeStr);if(t)return this.$message.warning("起始日期不能大于当前日期"),void(this.form.drugTreatmentBeginTimeStr="");"一年"==this.form.drugTreatmentTimeLimit?(e.setFullYear(e.getFullYear()+1),e.setDate(e.getDate()-1),this.form.drugTreatmentEndTimeStr=this.moment(e).format("YYYY-MM-DD"),this.isDisabled=!0):"两年"==this.form.drugTreatmentTimeLimit?(e.setFullYear(e.getFullYear()+2),e.setDate(e.getDate()-1),this.form.drugTreatmentEndTimeStr=this.moment(e).format("YYYY-MM-DD"),this.isDisabled=!0):"三年"==this.form.drugTreatmentTimeLimit?(e.setFullYear(e.getFullYear()+3),e.setDate(e.getDate()-1),this.form.drugTreatmentEndTimeStr=this.moment(e).format("YYYY-MM-DD"),this.isDisabled=!0):(this.moment(this.form.drugTreatmentEndTimeStr).format("YYYY-MM-DD"),this.isDisabled=!1)}},onDateChange2:function(e){var t=Object(g["b"])(e);t||(this.$message.warning("截止日期要大于当前日期"),this.form.drugTreatmentEndTimeStr="")},onDateChange3:function(e){var t=Object(g["b"])(e);t&&(this.$message.warning("入所日期要小于当前日期"),this.form.insertTimeStr="")},onDateChange4:function(e){var t=Object(g["b"])(e);t&&(this.$message.warning("初次吸毒日期要小于当前日期"),this.form.firstDrugTimeStr="")},submit:function(){var e=this;this.$refs.formModal.validate((function(t){if(t)if("add"==e.$route.query.type){if(void 0===e.form.avatar||""===e.form.avatar)return e.$message.warning("请上传图片"),!1;e.new_abstain()}else e.edit_abstain_outReason()}))},new_abstain:function(){var e=this,t={identityCard:this.form.identityCard,avatar:this.form.avatar,birthday:this.form.birthday,phone:this.form.phone,currentAddress:this.form.currentAddress,education:this.form.education,householdAddress:this.form.householdAddress,householdTown:this.form.householdTown,marriage:this.form.marriage,nation:this.form.nation,nickName:this.form.nickName,realName:this.form.realName,sex:this.form.sex,background:this.form.background};this.form.drugPersonTypeStr=this.form.drugPersonTypeStr.join();var a=Object.assign({createBasePersonVO:t},{departmentId:this.departmentId},{level:this.level},this.form);f["a"].add_abstain(a).then((function(t){t&&(e.$message.success("新增成功"),window.history.go(-1))}))},edit_abstain_outReason:function(){var e=this,t={},a=this.form,r=a.actionCause,i=a.decisionMakingOrgan,s=a.drugPersonTypeStr,o=a.drugTreatmentBeginTimeStr,n=a.drugTreatmentEndTimeStr,d=a.drugTreatmentTimeLimit,m=a.firstDrugTimeStr,l=a.insertReason,u=a.insertTimeStr,c=a.otherDrugTypeName;t={actionCause:r,decisionMakingOrgan:i,drugPersonTypeStr:s,drugTreatmentBeginTimeStr:o,drugTreatmentEndTimeStr:n,drugTreatmentTimeLimit:d,firstDrugTimeStr:m,insertReason:l,insertTimeStr:u,otherDrugTypeName:c},t.id=this.id,t.drugPersonTypeStr=t.drugPersonTypeStr.join(),f["a"].edit_abstain(t).then((function(t){t&&(e.$message.success("修改成功"),window.history.go(-1))}))},get_info:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.form.identityCard){t.next=3;break}return e.$message.warning("请输入证件号"),t.abrupt("return");case 3:e.btnLoading=!0,u["a"].getPersonInfoByIdCardJg({identityCard:e.form.identityCard}).then((function(t){if(t){if(e.btnLoading=!1,e.initDisabledObj(!1),""===t.realName)e.$message.warning("人员库中没有该人员数据，请手动录入"),e.isEdit=!1;else{for(var a in e.form=t,e.form)null!==e.form[a]&&""!==e.form[a]&&void 0!==e.form[a]&&(e.disabledObj[a]=!0);e.isEdit=!0}e.form.drugRehabilitationName=e.$route.query.areaName}})).catch((function(){e.btnLoading=!1}));case 5:case"end":return t.stop()}}),t)})))()},confirm:function(e){this.$message.success("提交成功"),window.history.go(-1)},getBaseInfo:function(){var e={},t={},a=new Map(Object.entries(this.form));for(var r in this.form)a.has(r)?t["".concat(r)]=this.form["".concat(r)]:e["".concat(r)]=this.form["".concat(r)];return e.createBasePersonVO=t,e},getAvatar:function(e){this.form.avatar=e}})},h=p,b=(a("91d4"),a("2877")),v=Object(b["a"])(h,r,i,!1,null,"1ea6f8c8",null);t["default"]=v.exports},"91d4":function(e,t,a){"use strict";var r=a("ed5f"),i=a.n(r);i.a},d8b0:function(e,t,a){"use strict";a.r(t);var r=a("cf45");t["default"]={rules:{identityCard:[{required:!1,message:"请输入身份证号"},{validator:r["f"]}],certificateType:[{required:!1,message:"请选择证件类型"}],nation:[{required:!1,message:"请输入名族"}],marriage:[{required:!1,message:"请选择婚姻状况"}],education:[{required:!1,message:"请选择学历"}],currentTown:[{required:!1,message:"请输入现居住乡镇"}],currentPoliceStation:[{required:!1,message:"请输入居住乡镇派出所"}],householdPoliceStation:[{required:!1,message:"请输入户籍所在派出所"}],realName:[{required:!1,message:"请输入姓名"},{validator:r["g"]}],nickName:[{required:!1,message:"请输入别名/绰号"}],phone:[{required:!1,message:"请输入电话号码"},{validator:r["h"]}],sex:[{required:!1,message:"请输入性别!"}],birthday:[{required:!1,message:"请选择出生日期"}],householdTown:[{required:!1,message:"请输入户籍所在派出所"},{validator:r["n"]}],householdAddressName:[{required:!1,message:"请输入户籍所在地"},{validator:r["n"]}],householdAddress:[{required:!1,message:"请输入户籍详细地"},{validator:r["n"]}],currentAddressName:[{required:!1,message:"请输入现居住地址"},{validator:r["n"]}],currentAddress:[{required:!1,message:"请输入现居住详情地址"},{validator:r["n"]}],drugTreatmentBeginTimeStr:[{required:!0,message:"请选择戒毒起始日期"}],drugTreatmentTimeLimit:[{required:!0,message:"请选择戒毒期限"}],drugTreatmentEndTimeStr:[{required:!0,message:"请选择戒毒终止日期"}],actionCause:[{required:!0,message:"请选择入罪名/案由"},{validator:r["p"]}],insertReason:[{required:!0,message:"请输入入所原因"},{validator:r["n"]}],insertTimeStr:[{required:!0,message:"请选择入所日期"}],drugRehabilitationName:[{required:!0,message:"请输入戒毒所名称"}],firstDrugTimeStr:[{required:!0,message:"请选择初次吸毒日期"}],drugPersonTypeStr:[{required:!0,message:"请选择滥用毒品类型"}],decisionMakingOrgan:[{required:!0,message:"请输入决定机关"},{validator:r["p"]}],drugPersonWayStr:[{required:!0,message:"请选择滥用毒品方式"}],background:[{required:!1,message:"请输入职业"},{validator:r["o"]}],height:[{required:!0,message:"请输入身高"}],nationality:[{required:!0,message:"请选择国际"}],receivePolice:[{required:!0,message:"接收派出所民警"},{validator:r["o"]}],outReason:[{required:!0,message:"出所原因"},{validator:r["p"]}],outTimeStr:[{required:!0,message:"出所日期"}],outWhere:[{required:!0,message:"出所详细地址"},{validator:r["n"]}],receivePolicePhone:[{required:!0,message:"接收派出所民警联系方式"},{validator:r["h"]}],familyName:[{required:!1,message:"家属姓名"},{validator:r["o"]}],familyPhone:[{required:!1,message:"家属联系方式"},{validator:r["h"]}]}}},ed5f:function(e,t,a){}}]);