(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7991054e","chunk-270c8fe8"],{"3cff":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"filter-wrapper"},[a("div",{staticClass:"filter-title"},[e._v("且（AND）")]),a("div",{staticClass:"filter-list"},[e._l(e.items,(function(t,r){return a("div",{key:r,staticClass:"filter-item"},[a("div",{staticClass:"filter-line"}),a("div",{staticClass:"filter-content"},[a("a-cascader",{staticClass:"content-item",attrs:{allowClear:!1,options:e.data,value:t[0]&&t[1]?t:null,expandTrigger:"hover",placeholder:"请选择"},on:{change:function(t){return e.onChange(t,r)}}}),a("a-input",{staticClass:"content-item",attrs:{placeholder:"请输入"},model:{value:t[2],callback:function(a){e.$set(t,2,a)},expression:"item[2]"}}),e.items.length>1?a("a-icon",{staticClass:"content-icon",attrs:{type:"delete"},on:{click:function(t){return e.deleteItem(r)}}}):e._e()],1)])})),a("div",{staticClass:"filter-item"},[a("span",{staticClass:"filter-line filter-line-last"}),a("div",{staticClass:"filter-content"},[a("a-button",{staticClass:"content-button",attrs:{type:"dashed",block:"",icon:"plus"},on:{click:e.addItem}})],1)])],2)])},i=[],s=(a("a434"),{name:"CustomFilter",props:{data:{type:Array,required:!0},items:{type:Array,default:function(){return[[null,null,""]]}}},data:function(){return{}},methods:{addItem:function(){this.items.push([null,null,""])},deleteItem:function(e){this.items.length>1&&this.items.splice(e,1)},onChange:function(e,t){e.push(this.items[t][2]),this.items.splice(t,1,e)}}}),n=s,o=(a("4cfd"),a("2877")),l=Object(o["a"])(n,r,i,!1,null,"6e08c210",null);t["default"]=l.exports},4602:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"新建",width:this.$config.modalWidth.middling},on:{ok:e.okHandler}},[a("a-form",{attrs:{form:e.form,labelCol:{span:6},wrapperCol:{span:18}}},[a("a-form-item",{attrs:{label:"数据来源范围"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["dataRange",{rules:[{required:!0,message:"请选择数据来源范围"}],initialValue:1}],expression:"[\n          'dataRange',\n          {\n            rules: [{ required: true, message: '请选择数据来源范围' }],\n            initialValue: 1,\n          },\n        ]"}]},[a("a-radio",{attrs:{value:1}},[e._v("基于数据来源")]),a("a-radio",{attrs:{value:2}},[e._v("基于条件")])],1)],1),2===this.form.getFieldValue("dataRange")?a("a-form-item",{attrs:{label:"规则名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ruleName",{rules:[{required:!0,message:"请输入规则名称"}],initialValue:e.ruleName}],expression:"[\n          'ruleName',\n          {\n            rules: [{ required: true, message: '请输入规则名称' }],\n            initialValue: ruleName,\n          },\n        ]"}],attrs:{placeholder:"请输入规则名称"},on:{change:e.onNameChange}})],1):e._e(),a("a-form-item",{attrs:{label:"数据来源"}},[a("SelectUser",{directives:[{name:"decorator",rawName:"v-decorator",value:["dataComesFrom",{rules:[{required:!0,message:"请选择数据来源"}]}],expression:"[\n          'dataComesFrom',\n          {\n            rules: [{ required: true, message: '请选择数据来源' }],\n          },\n        ]"}],attrs:{multiple:!0,placeholder:"请选择数据来源"}})],1),a("a-form-item",{attrs:{label:"共享对象"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["tableMetaId",{rules:[{required:!0,message:"请输入共享对象"}],initialValue:0===e.tableMetaId?null:e.tableMetaId}],expression:"[\n          'tableMetaId',\n          {\n            rules: [{ required: true, message: '请输入共享对象' }],\n            initialValue: tableMetaId === 0 ? null : tableMetaId,\n          },\n        ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入共享对象"},on:{select:e.onShareObjectSelect}},e._l(e.objectsAndConditionsData,(function(t){return a("a-select-option",{key:t.objectMetaId,attrs:{value:t.objectMetaId,options:t.options}},[e._v(" "+e._s(t.objectTitle)+" ")])})),1)],1),a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:2===this.form.getFieldValue("dataRange"),expression:"this.form.getFieldValue('dataRange') === 2"}],attrs:{wrapperCol:{offset:3,span:21}}},[a("CustomFilter",{attrs:{data:e.options,items:e.filterItems}})],1),a("a-form-item",{attrs:{label:"共享范围"}},[a("SelectUser",{directives:[{name:"decorator",rawName:"v-decorator",value:["dataShareTo",{rules:[{required:!0,message:"请选择共享范围"}]}],expression:"[\n          'dataShareTo',\n          {\n            rules: [{ required: true, message: '请选择共享范围' }],\n          },\n        ]"}],attrs:{multiple:!0,placeholder:"请选择共享范围"}})],1),a("a-form-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 到期时间 "),a("a-tooltip",{attrs:{title:"数据权限有效时间，当为空时表示永久"}},[a("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["expireDateTime"],expression:"['expireDateTime']"}],staticStyle:{width:"100%"},attrs:{showTime:"",placeholder:"为空表示永久"}})],1),a("a-form-item",{attrs:{label:"共享权限"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["flagPriv",{rules:[{required:!0,message:"请选择共享权限"}],initialValue:!1}],expression:"[\n          'flagPriv',\n          {\n            rules: [{ required: true, message: '请选择共享权限' }],\n            initialValue: false,\n          },\n        ]"}]},[a("a-radio",{attrs:{value:!1}},[e._v("只读")]),a("a-radio",{attrs:{value:!0,disabled:!0}},[e._v("读写")])],1)],1)],1)],1)},i=[],s=(a("4de4"),a("d81d"),a("a9e3"),a("5530")),n=a("2f62"),o=a("86da"),l=a("a669"),d=a("3cff"),c=(a("c32a"),{name:"AddDataShareModal",components:{Modal:o["a"],CustomFilter:d["default"],SelectUser:l["a"]},props:{tableMetaId:{type:Number,required:!1,default:0}},data:function(){return{form:this.$form.createForm(this),filterItems:[[]],ruleName:"",options:[]}},mounted:function(){},computed:Object(s["a"])({},Object(n["d"])({loading:function(e){return e.SysPrivilege.loading},objectsAndConditionsData:function(e){return e.SysPrivilege.objectsAndConditionsData}})),watch:{tableMetaId:function(e){var t=this.objectsAndConditionsData.filter((function(t){return t.objectMetaId===e}))[0];this.options=t?t.options:[]}},methods:Object(s["a"])(Object(s["a"])({},Object(n["b"])({onSaveDataSharing:"SysPrivilege/onSaveDataSharing"})),{},{show:function(){this.form.resetFields(),this.filterItems=[[]],this.$refs.modal.show()},onNameChange:function(e){this.ruleName=e.target.value},onShareObjectSelect:function(e,t){this.options=t.data.attrs.options||[]},okHandler:function(){var e=this,t=this.form.validateFields,a=this.filterItems;t((function(t,r){console.log(JSON.stringify(r),a,a.map((function(e){return{fieldComparator:e[1]||0,fieldComparatorValue:e[2]||"",fieldMetaId:e[0]||0}}))),t||e.onSaveDataSharing(Object(s["a"])(Object(s["a"])({},r),{},{dataComesFrom:r.dataComesFrom.map((function(e){return{id:e,type:0}})),dataShareTo:r.dataShareTo.map((function(e){return{id:e,type:0}})),objectConditions:2===r.dataRange?a.map((function(e){return{fieldComparator:e[1]||0,fieldComparatorValue:e[2]||"",fieldMetaId:e[0]||0}})):[]})).then((function(){e.$message.success("新建成功"),e.$emit("success"),e.$refs.modal.close()}))}))}})}),u=c,m=a("2877"),f=Object(m["a"])(u,r,i,!1,null,"627b2f15",null);t["default"]=f.exports},"4cfd":function(e,t,a){"use strict";var r=a("6d3a"),i=a.n(r);i.a},"6d3a":function(e,t,a){}}]);