(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-114b62b4","chunk-5062fe0e","chunk-623fd268"],{"15a1":function(e,t,a){"use strict";var s=a("f560"),n=a.n(s);n.a},"22f85":function(e,t,a){"use strict";var s=a("809f"),n=a.n(s);n.a},4788:function(e,t,a){},"691d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree"},[a("a-input-search",{attrs:{placeholder:"输入搜选项"},on:{search:e.onSearch},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}}),a("a-tree",{attrs:{showIcon:"",checkable:"",treeData:e.treeData,selectedKeys:e.selectKey,expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:!0},on:{expand:e.onExpand,check:e.jiantingcheck},scopedSlots:e._u([{key:"title",fn:function(t){var s=t.title,n=t.type;return[a("a-icon",{attrs:{type:1==n?"user":"copy"}}),a("span",{domProps:{innerHTML:e._s(s.replace(new RegExp(e.searchValue,"g"),"<span style=color:#f50>"+e.searchValue+"</span>"))}})]}}]),model:{value:e.selectKey,callback:function(t){e.selectKey=t},expression:"selectKey"}},[a("a-icon",{attrs:{slot:"switcherIcon",type:"down"},slot:"switcherIcon"}),a("a-icon",{attrs:{slot:"smile",type:"smile-o"},slot:"smile"}),a("a-icon",{attrs:{slot:"meh",type:"smile-o"},slot:"meh"})],1)],1)},n=[],r=(a("4160"),a("c975"),a("d81d"),a("fb6a"),a("45fc"),a("159b"),a("5530")),i=a("2f62"),c={name:"userTree",data:function(){return{backupsExpandedKeys:[],autoExpandParent:!1,checkedKeys:[],selectedKeys:[],searchValue:"",searchStr:"",expandedKeys:[],treeData:[],selectKey:[],selectObj:[]}},props:{userOrDeptSelectKeys:{type:Array,required:!1},allKeys:{type:Array,required:!1},userOrDeptSelectObjs:{type:Array,required:!1}},created:function(){var e=this;this.selectKey=this.allKeys,console.log(this.getDepTree()),this.getDepTree().then((function(t){console.log(t);var a=JSON.parse(JSON.stringify(t));e.treeData=e.initData(a)}))},mounted:function(){},computed:Object(r["a"])({},Object(i["d"])({loading:function(e){return e.SysDepartment.loading}})),methods:Object(r["a"])(Object(r["a"])({},Object(i["b"])({getDepTree:"SysDepartment/getUserAndDeptTree"})),{},{jiantingcheck:function(e,t){var a=[];t.checkedNodes.forEach((function(e){a.push(e.data.props.dataRef)}));this.selectObj=a},initData:function(e,t,a){var s=this;return e.forEach((function(e){e.scopedSlots={title:"title"},t&&(e.parentName=a),e.children&&e.children.length>0&&s.initData(e.children,e.key,e.title)})),e},onSearch:function(){var e=this;if(e.searchValue=e.searchStr,""===e.searchValue)e.expandedKeys=[];else{e.expandedKeys=[],e.backupsExpandedKeys=[];var t=e.getkeyList(e.searchValue,e.treeData,[]);t.map((function(t){var a=e.getParentKey(t,e.treeData);a&&!e.backupsExpandedKeys.some((function(e){return e===a}))&&e.backupsExpandedKeys.push(a)}));for(var a=this.backupsExpandedKeys.length,s=0;s<a;s++)e.getAllParentKey(e.backupsExpandedKeys[s],e.treeData);e.expandedKeys=e.backupsExpandedKeys.slice()}},getkeyList:function(e,t,a){for(var s=0;s<t.length;s++){var n=t[s];n.title.indexOf(e)>-1&&a.push(n.key),n.children&&this.getkeyList(e,n.children,a)}return a},getParentKey:function(e,t){for(var a,s,n=0;n<t.length;n++){var r=t[n];r.children&&(r.children.some((function(t){return t.key===e}))?a=r.key:(s=this.getParentKey(e,r.children))&&(a=s))}return a},getAllParentKey:function(e,t){var a;e&&(a=this.getParentKey(e,t),a&&(this.backupsExpandedKeys.some((function(e){return e===a}))||this.backupsExpandedKeys.push(a),this.getAllParentKey(a,t)))},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},onCheck:function(e){this.checkedKeys=e},onSelect:function(e,t){this.selectedKeys=e}}),watch:{selectObj:function(e){this.$emit("setdeptOrUserSelectObjs",e,this.selectKey)},streeData:function(e){this.treeData=JSON.parse(JSON.stringify(e))},allKeys:function(e){this.selectKey=e}}},l=c,o=(a("15a1"),a("2877")),u=Object(o["a"])(l,s,n,!1,null,"9a589882",null);t["default"]=u.exports},"809f":function(e,t,a){},"9fa9":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{width:610,title:"请选择使用范围"},on:{ok:e.submit,close:e.close}},[a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"bottom"},[a("div",{staticClass:"tab"},[a("div",{staticClass:"user list",class:"User"==e.comName?"active":"",on:{click:function(t){t.preventDefault(),e.comName="User"}}},[e._v(" 用户 ")]),a("div",{staticClass:"dept list",class:"Dept"==e.comName?"active":"",on:{click:function(t){t.preventDefault(),e.comName="Dept"}}},[e._v(" 部门 ")])]),a("div",{staticClass:"tree"},[a("User",{directives:[{name:"show",rawName:"v-show",value:"User"==e.comName,expression:"comName == 'User'"}],attrs:{allKeys:e.allKeys},on:{setdeptOrUserSelectObjs:e.setdeptOrUserSelectObjs}}),a("Dept",{directives:[{name:"show",rawName:"v-show",value:"Dept"==e.comName,expression:"comName == 'Dept'"}],attrs:{allKeys:e.allKeys},on:{setdeptSelectObjs:e.setdeptSelectObjs}})],1)])]),a("div",{staticClass:"right"},[a("div",{staticClass:"right_top"},[a("div",{staticClass:"lf"},[e._v("已选"+e._s(e.allKeys.length))]),a("div",{staticClass:"rt",on:{click:function(t){return e.rest()}}},[e._v("清空")])]),a("div",{staticClass:"right_content"},[a("div",e._l(e.delSonRepeat(e.deptSelectObjs,e.userOrDeptSelectObjs),(function(t,s){return a("div",{key:s,staticClass:"selectList"},[e._v(" "+e._s(t.title)+" ")])})),0)])])])])},n=[],r=(a("99af"),a("7db0"),a("4160"),a("caad"),a("d81d"),a("2532"),a("159b"),a("b85c")),i=a("2909"),c=a("5530"),l=a("2f62"),o=a("86da"),u=a("691d"),d=a("f86e"),h={components:{Modal:o["a"],Dept:d["default"],User:u["default"]},data:function(){return{comName:"User",deptSelectObjs:[],deptSelectKeys:[],userOrDeptSelectKeys:[],userOrDeptSelectObjs:[],allKeys:[],allObjs:[]}},props:{title:{type:String,default:"",required:!1},showFigure:{type:Boolean,default:!0,required:!1}},created:function(){},mounted:function(){},computed:Object(c["a"])({},Object(l["d"])({loading:function(e){return e.SysDepartment.loading}})),methods:Object(c["a"])(Object(c["a"])({},Object(l["b"])({})),{},{setKey:function(e){e&&(this.allObjs=e.map((function(e){1==e.type?e.key="user_".concat(e.value):e.key=e.value})),this.allKeys=e.map((function(e){return e.key})),this.allObjs=e)},setdeptOrUserSelectObjs:function(e,t){var a=this;t.forEach((function(e){a.allKeys.includes(e)||a.allKeys.push(e)})),console.log(e),this.userOrDeptSelectKeys=t,this.userOrDeptSelectObjs=e},setdeptSelectObjs:function(e,t){var a=this;t.forEach((function(e){a.allKeys.includes(e)||a.allKeys.push(e)})),console.log(this.deptSelectObjs),this.deptSelectObjs=e,this.deptSelectKeys=t},rest:function(){this.allKeys=[],this.userOrDeptSelectKeys=[],this.userOrDeptSelectObjs=[],this.deptSelectKeys=[],this.deptSelectObjs=[]},delSonRepeat:function(e,t){var a=[].concat(Object(i["a"])(e),Object(i["a"])(t));return this.process(a)},process:function(e){var t,a=[],s=Object(r["a"])(e);try{var n=function(){var e=t.value;a.find((function(t){return t.key===e.key}))||a.push(e)};for(s.s();!(t=s.n()).done;)n()}catch(i){s.e(i)}finally{s.f()}return this.allObjs=a,a},showDeptData:function(){this.treeData=this.treeDeptData},showUserData:function(){this.treeData=this.treeDeptData},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},submit:function(){this.deptSelectObjs=[],this.deptSelectKeys=[],this.userOrDeptSelectKeys=[],this.userOrDeptSelectObjs=[],this.$emit("setcoped",this.allObjs),this.close()},close:function(){this.$refs.modal.visible=!1}}),watch:{selectKey:function(e){console.log("onCheck",e)}}},p=h,f=(a("e443"),a("2877")),y=Object(f["a"])(p,s,n,!1,null,"6813855a",null);t["default"]=y.exports},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");var s=a("06c5");function n(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=Object(s["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return c=e.done,e},e:function(e){l=!0,i=e},f:function(){try{c||null==a["return"]||a["return"]()}finally{if(l)throw i}}}}},e443:function(e,t,a){"use strict";var s=a("4788"),n=a.n(s);n.a},f560:function(e,t,a){},f86e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tree"},[a("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"Search"},on:{change:e.onChange}}),a("a-tree",{attrs:{checkable:"",treeData:e.treeData,selectedKeys:e.selectKey,expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:!0},on:{expand:e.onExpand,select:e.selectNode,check:e.jiantingcheck},scopedSlots:e._u([{key:"custom",fn:function(t){t.title.indexOf(e.searchValue)}}],null,!0),model:{value:e.selectKey,callback:function(t){e.selectKey=t},expression:"selectKey"}})],1)])},n=[],r=(a("4de4"),a("4160"),a("c975"),a("d81d"),a("45fc"),a("159b"),a("5530")),i=a("2f62"),c=function e(t,a,s){for(var n=0;n<t.length;n++)t[n].scopedSlots={title:"custom"},a&&(t[n].parentId=a,t[n].parentName=s),t[n].children&&t[n].children.length>0&&e(t[n].children,t[n].key,t[n].title);return t},l={name:"DeptTree",props:{allKeys:{type:Array,required:!1},deptSelectKeys:{type:Array,required:!1},userOrDeptSelectObjs:{required:!1}},data:function(){return{comName:"User",expandedKeys:[],dataList:[],userTreeData:[],treeData:[],autoExpandParent:!0,selectKey:this.deptSelectKeys,selectObj:[],confirmVisible:{},itemIndex:"",searchValue:"",treeDeptData:[],depSearch:{searchName:""}}},created:function(){var e=this;this.selectKey=this.allKeys,this.getDepTree().then((function(t){t.forEach((function(e){e.children.map})),e.expandedKeys=[t[0].key],e.generateList(t),e.$emit("selectDep",t[0].key,t[0].title)}))},mounted:function(){},computed:Object(r["a"])({},Object(i["d"])({loading:function(e){return e.SysDepartment.loading},streeData:function(e){var t=e.SysDepartment.treeData,a=JSON.parse(JSON.stringify(t));return c(a)}})),methods:Object(r["a"])(Object(r["a"])({},Object(i["b"])({getDeptTree:"SysDepartment/getTree"})),{},{change:function(e){this.$emit("change",e)},jiantingcheck:function(e,t){var a=[];t.checkedNodes.forEach((function(e){a.push(e.data.props.dataRef)}));this.selectObj=a,this.$parent},showDeptData:function(){this.treeData=this.treeDeptData},showUserData:function(){this.treeData=this.treeDeptData},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},generateList:function(e){for(var t=0;t<e.length;t++){var a=e[t];void 0===a.scopedSlots&&(a.scopedSlots={title:"title"}),this.dataList.push({key:a.key,title:a.title}),a.children&&this.generateList(a.children)}},getParentKey:function(e,t){for(var a,s=0;s<t.length;s++){var n=t[s];n.children&&(n.children.some((function(t){return t.title===e}))?a=n.key:this.getParentKey(e,n.children)&&(a=this.getParentKey(e,n.children)))}return this.treeData=c(t),a},onChange:function(e){var t,a=this,s=e.target.value;this.treeData=JSON.parse(JSON.stringify(this.$store.state.SysDepartment.treeData)),this.treeData[0].children=[],s?t=this.dataList.map((function(e){if(e.title.indexOf(s)>-1){var t=JSON.parse(JSON.stringify(a.$store.state.SysDepartment.treeData));return a.getParentKey(e.title,t)}return null})).filter((function(e,t,a){return e&&a.indexOf(e)===t})):(this.treeData=c(JSON.parse(JSON.stringify(this.$store.state.SysDepartment.treeData))),t=[this.treeData[0].key]),0===t.length&&this.$message.info("当前搜索无对应信息"),Object.assign(this,{expandedKeys:t,searchValue:s,autoExpandParent:!0})},selectNode:function(e,t){this.selectKey=e;var a=t.selectedNodes[0].data.props.dataRef.title;e&&e.length>0&&this.$emit("selectDep",e[0],a)},addDep:function(e,t,a){a&&a.indexOf("tenant")>-1||this.$emit("addDep",e,t)},editDep:function(e){this.$emit("editDep",e)},changeStatus:function(e){var t=e.key,a=e.status;this.$emit("changeStatus",t,a)},getDepTreeData:function(){var e=this;this.dataList=[],this.getDepTree(this.depSearch).then((function(t){e.generateList(t)}))},submit:function(){},close:function(){}}),watch:{selectObj:function(e){this.$emit("setdeptSelectObjs",e,this.selectKey)},streeData:function(e){this.treeData=JSON.parse(JSON.stringify(e))},allKeys:function(e){this.selectKey=e}}},o=l,u=(a("22f85"),a("2877")),d=Object(u["a"])(o,s,n,!1,null,"b10eefd8",null);t["default"]=d.exports}}]);