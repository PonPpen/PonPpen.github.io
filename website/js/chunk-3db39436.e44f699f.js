(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3db39436","chunk-da90f5d6","chunk-29dd226d"],{"04a9":function(e,t,n){},"096e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{ref:"modalIcon",attrs:{title:"图标",footer:null,width:1e3}},[n("ul",{staticClass:"icon-list"},e._l(e.iconList,(function(t,a){return n("li",{key:a,class:{cur:t.name==e.icon},on:{click:function(n){return e.chooseIcon(t)}}},[n("a-icon",{attrs:{type:t.name,theme:e.getTheme(t)}}),n("span",[e._v(e._s(t.name))])],1)})),0)])},r=[],i=(n("99af"),n("4de4"),n("b0c0"),n("07ac"),n("8520")),o=n("86da"),s={components:{Modal:o["a"]},data:function(){return{parentId:"",parentName:"",visible:!1,icons:i["a"].definitions.collection,iconList:[],theme:"outline"}},props:{icon:{type:String,default:"",required:!1}},created:function(){this.getThemeIcons()},computed:{},methods:{close:function(){this.parentId="",this.$refs.modalIcon.close()},show:function(){this.$refs.modalIcon.show()},getContent:function(e){var t=this.getTheme(e);return"outlined"===t?'<a-icon :type="'.concat(e.name,'"  />'):'<a-icon :type="'.concat(e.name,'" :theme="').concat(t,'" />')},getThemeIcons:function(){var e=this;"gold"==this.theme?this.iconList=Object.values(this.icons).filter((function(e){return e})):this.iconList=Object.values(this.icons).filter((function(t){return t.theme==e.theme}))},handleThemeChange:function(e){this.theme=e.target.value,this.getThemeIcons()},getTheme:function(e){return"outline"==e.theme?"outlined":"fill"==e.theme?"filled":"twotone"==e.theme?"twoTone":void 0},chooseIcon:function(e){this.$emit("getIcon",e.name),this.$refs.modalIcon.close()}}},u=s,c=(n("3950"),n("2877")),l=Object(c["a"])(u,a,r,!1,null,"a12dd436",null);t["default"]=l.exports},3950:function(e,t,n){"use strict";var a=n("8489"),r=n.n(a);r.a},"3ed0":function(e,t,n){"use strict";var a=n("04a9"),r=n.n(a);r.a},5099:function(e,t,n){"use strict";var a=n("a2d6"),r=n.n(a);r.a},"794b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"dep-tree",loading:!0}},[n("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"搜索"},on:{change:e.onChange}}),n("a-tree",{attrs:{treeData:e.menuTreeData,expandedKeys:e.expandedKeys,autoExpandParent:e.autoExpandParent,showLine:!0,selectedKeys:e.defaultSelectedKeys,defaultExpandAll:!0,draggable:""},on:{expand:e.onExpand,select:e.selectNode,dragenter:e.onDragEnter,drop:e.onDrop},scopedSlots:e._u([{key:"custom",fn:function(t){return[t.title.indexOf(e.searchValue)>-1?n("span",[e._v(" "+e._s(t.title.substr(0,t.title.indexOf(e.searchValue)))+" "),n("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(t.title.substr(t.title.indexOf(e.searchValue)+e.searchValue.length))+" ")]):n("span",[e._v(e._s(t.title))]),n("div",{staticClass:"tree-todo"},[n("a-dropdown",[n("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v("操作"),n("a-icon",{attrs:{type:"down"}})],1),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"0"},[n("a",{attrs:{target:"_blank",rel:"noopener noreferrer"},on:{click:function(n){return e.addMenu(t.key,t.title)}}},[e._v("新建下级菜单")])]),n("a-menu-item",{key:"1"},[n("a",{style:{cursor:t.key.indexOf("tenant")>-1?"not-allowed":"pointer"},attrs:{target:"_blank",rel:"noopener noreferrer"},on:{click:function(n){return e.addMenu(t.parentId,t.parentName,t.key)}}},[e._v("新建同级菜单")])]),n("a-menu-item",{key:"2"},[n("a",{attrs:{target:"_blank",rel:"noopener noreferrer"},on:{click:function(n){return e.deleteMenu(t)}}},[e._v("删除")])])],1)],1)],1)]}}])})],1)},r=[],i=(n("4de4"),n("4160"),n("c975"),n("d81d"),n("45fc"),n("a434"),n("b0c0"),n("a9e3"),n("d3b7"),n("ac1f"),n("1276"),n("159b"),n("2909")),o=(n("96cf"),n("1da1")),s=n("5530"),u=(n("4360"),n("2f62")),c=function e(t,n,a){for(var r=0;r<t.length;r++)t[r].scopedSlots={title:"custom"},n&&(t[r].parentId=n,t[r].parentName=a),t[r].children&&t[r].children.length>0&&e(t[r].children,t[r].key,t[r].title);return t},l={name:"MenuTree",props:{processList:{type:Array,default:function(){return[]}}},data:function(){return{itemIndex:"",expandedKeys:[],searchValue:"",autoExpandParent:!0,dataList:[],depSearch:{searchName:""},defaultSelectedKeys:[],myArray:[{id:1,name:"我是1号"},{id:2,name:"我是2号"},{id:3,name:"我是3号"},{id:4,name:"我是4号"},{id:5,name:"我是5号"}]}},computed:Object(s["a"])({},Object(u["d"])({loading:function(e){return e.SysMenu.loading},menuTreeData:function(e){var t=[],n=e.SysMenu.menuTree;return t=Object.assign([],n),c(t)}})),created:function(){var e=this;this.getMenuTree({}).then((function(t){t&&t[0]&&(e.defaultSelectedKeys=[t[0].key],e.selectNode(e.defaultSelectedKeys),e.generateList(t),e.$emit("selectMenu",e.defaultSelectedKeys))}))},methods:Object(s["a"])(Object(s["a"])({},Object(u["b"])({getMenuTree:"SysMenu/onGetMenuTree",onDeleteMenu:"SysMenu/onForbidMenu"})),{},{addMenu:function(e,t,n){this.$emit("addMenu",e,t,n)},deleteMenu:function(e){var t=this;this.$confirm({content:"确认要删除".concat(e.title,"？"),onOk:function(){return new Promise((function(n,a){t.onDeleteMenu(e.key).then((function(n){t.$message.success("菜单".concat(e.title,"删除成功")),t.getMenuTreeData()})),self.destroyAll()})).catch((function(e){return console.log("err"+e)}))},onCancel:function(){console.log("取消删除菜单")}})},selectNode:function(e,t){e.length>0&&(this.defaultSelectedKeys=e,this.$emit("selectMenu",this.defaultSelectedKeys))},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},generateList:function(e){for(var t=0;t<e.length;t++){var n=e[t];void 0===n.scopedSlots&&(n.scopedSlots={title:"title"}),this.dataList.push({key:n.key,title:n.title}),n.children&&this.generateList(n.children)}},getParentKey:function(e,t){for(var n,a=0;a<t.length;a++){var r=t[a];r.children&&(r.children.some((function(t){return t.title===e}))?n=r.key:this.getParentKey(e,r.children)&&(n=this.getParentKey(e,r.children)))}return n},onChange:function(e){for(var t=this,n=e.target.value,a=""===n?["0"]:this.dataList.map((function(e){return e.title.indexOf(n)>-1?t.getParentKey(e.title,t.menuTreeData):null})).filter((function(e,t,n){return e&&n.indexOf(e)===t})),r=!0,i=0;i<this.dataList.length;i++)if(this.dataList[i].title.indexOf(n)>-1){r=!1;break}r&&this.$message.info("当前搜索无对应信息"),Object.assign(this,{expandedKeys:a,searchValue:n,autoExpandParent:!0})},addDep:function(e,t,n){n&&n.indexOf("tenant")>-1||(this.$emit("addDep",e,t),console.log(e,t))},editDep:function(e){this.$emit("editDep",e)},getMenuTreeData:function(){var e=this;this.dataList=[],this.getMenuTree(this.depSearch).then((function(t){e.generateList(t)}))},datadragEnd:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.preventDefault(),console.log("拖动前的索引 :"+e.oldIndex),console.log("拖动后的索引 :"+e.newIndex),a=t.myArray,n.next=6,a.map((function(e,t){return{sort_order:t,name:e.name,id:e.id}}));case 6:r=n.sent,console.log(r);case 8:case"end":return n.stop()}}),n)})))()},onDragEnter:function(e){console.log(e)},onDrop:function(e){console.log(e);var t,n=e.node.eventKey,a=e.dragNode.eventKey,r=e.node.pos.split("-"),o=e.dropPosition-Number(r[r.length-1]),s=function e(t,n,a){t.forEach((function(t,r,i){return t.key===n?a(t,r,i):t.children?e(t.children,n,a):void 0}))},u=Object(i["a"])(this.menuTreeData);if(s(u,a,(function(e,n,a){a.splice(n,1),t=e})),e.dropToGap)if((e.node.children||[]).length>0&&e.node.expanded&&1===o)s(u,n,(function(e){e.children=e.children||[],e.children.unshift(t)}));else{var c,l;s(u,n,(function(e,t,n){c=n,l=t})),-1===o?c.splice(l,0,t):c.splice(l+1,0,t)}else s(u,n,(function(e){e.children=e.children||[],e.children.push(t)}));console.log(u)}})},d=l,f=(n("5099"),n("2877")),m=Object(f["a"])(d,a,r,!1,null,"8e5b11ea",null);t["default"]=m.exports},8489:function(e,t,n){},a2d6:function(e,t,n){},d0bf:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PageView",[n("SplitLayout",{attrs:{leftWidth:"240px"}},[n("div",{staticClass:"tree-container",attrs:{slot:"left"},slot:"left"},[n("MenuTree",{ref:"menuTree",on:{addMenu:e.addMenu,selectMenu:e.selectMenu}})],1),n("div",[n("div",{staticClass:"tool-bar"},[n("OperationPermission",{attrs:{check:"privs.item1060000000"}},[n("a-button",{attrs:{type:"primary"},on:{click:e.addButtonMenu}},[e._v("新增菜单")])],1),n("OperationPermission",{attrs:{check:"privs.item1140000001"}},[n("a-button",{on:{click:e.onUpdateMenu}},[e._v("修改")])],1)],1),n("div",{staticClass:"detail-form"},[n("a-form",{attrs:{form:e.form,labelCol:{span:7},wrapperCol:{span:10}}},[n("a-form-item",{attrs:{label:"菜单名称"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["menuName",{initialValue:e.menuDetail.menuName?e.menuDetail.menuName:"",rules:[{required:!0,message:"请输入菜单名称"}]}],expression:"[\n                'menuName',\n                {\n                  initialValue: menuDetail.menuName\n                    ? menuDetail.menuName\n                    : '',\n                  rules: [{ required: true, message: '请输入菜单名称' }]\n                }\n              ]"}]})],1),n("a-form-item",{attrs:{label:"上级菜单","has-feedback":""}},[n("MenuTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentId",{initialValue:e.menuDetail.parentId?String(e.menuDetail.parentId):"",rules:[{required:!1,message:"请选择上级菜单"}]}],expression:"[\n                'parentId',\n                {\n                  initialValue: menuDetail.parentId\n                    ? String(menuDetail.parentId)\n                    : '',\n                  rules: [{ required: false, message: '请选择上级菜单' }]\n                }\n              ]"}],ref:"MenuTreeSelect",attrs:{selectMenu:e.menuDetail.parentId},on:{getValue:e.getSelectTree}})],1),n("a-form-item",{attrs:{label:"图标"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["icon",{initialValue:e.menuDetail.icon?e.menuDetail.icon:"",rules:[{required:!1}]}],expression:"[\n                'icon',\n                {\n                  initialValue: menuDetail.icon ? menuDetail.icon : '',\n                  rules: [{ required: false }]\n                }\n              ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择图标"},on:{click:e.selectIcon}}),e.menuDetail.icon?n("a-icon",{staticStyle:{position:"absolute",top:"0",right:"-34px",color:"#096dd9","font-size":"20px"},attrs:{type:e.menuDetail.icon,theme:"filled"},on:{click:e.selectIcon}}):e._e()],1),n("a-form-item",{attrs:{label:"菜单功能"}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["appId",{initialValue:e.menuDetail.appId?e.menuDetail.appId:"",rules:[{required:!1}]}],expression:"[\n                'appId',\n                {\n                  initialValue: menuDetail.appId ? menuDetail.appId : '',\n                  rules: [{ required: false }]\n                }\n              ]"}],attrs:{allowClear:"","show-search":"","filter-option":e.filterOption,placeholder:"请选择菜单功能"}},e._l(e.appsArr,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.moduleMetaId}},[e._v(" "+e._s(t.moduleTitle)+" ")])})),1)],1)],1)],1)]),n("AddMenu",{ref:"addMenu",on:{menuAddSuccess:e.queryMenuTree}}),n("Icons",{ref:"icons",attrs:{icon:e.menuDetail.icon},on:{getIcon:e.getIcon}})],1)],1)},r=[],i=(n("c975"),n("d81d"),n("d3b7"),n("96cf"),n("1da1")),o=n("5530"),s=n("2f62"),u=n("794b"),c=n("74c0"),l=n("f88a"),d=n("096e"),f=(n("1e96"),{components:{MenuTree:u["default"],AddMenu:l["default"],MenuTreeSelect:c["default"],Icons:d["default"]},data:function(){return{searchForm:{deptId:""},form:this.$form.createForm(this),depSearch:{},menuDetail:{},currentMenu:"",currentParentId:""}},created:function(){this.onGetApps({})},mounted:function(){},computed:Object(o["a"])({},Object(s["d"])({loading:function(e){return e.SysDepartment.loading},appsArr:function(e){return e.SysMenu.appsData}})),watch:{},methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])({getMenuDetail:"SysMenu/onGetMenuDetail",updateMenu:"SysMenu/onUpdateMenu",onGetApps:"SysMenu/onGetApps",onDeleteMenu:"SysMenu/deleteMenu",onGetBindApp:"SysMenu/onGetBindApp"})),{},{getSelectTree:function(e){this.currentParentId=e,this.menuDetail.parentId=e},selectMenu:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.currentMenu=e,n.next=3,t.getMenuDetail(e);case 3:a=n.sent,a&&(t.menuDetail=a,t.form.setFieldsValue(t.menuDetail));case 5:case"end":return n.stop()}}),n)})))()},onUpdateMenu:function(){var e=this,t=this,n=this.form.getFieldsValue();n.parentId=this.menuDetail.parentId,this.form.setFieldsValue(n),this.form.validateFieldsAndScroll(function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(a,r){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a){n.next=14;break}return r.id=t.currentMenu&&t.currentMenu.length>0?t.currentMenu[0]:"",n.next=4,e.updateMenu(r);case 4:if(i=n.sent,!i){n.next=12;break}return n.next=8,t.queryMenuTree();case 8:return n.next=10,t.$message.success("修改成功");case 10:return n.next=12,e.$refs.MenuTreeSelect.setData();case 12:n.next=14;break;case 14:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},addMenu:function(e,t,n){e&&(this.$refs.addMenu.parentId=e),t&&(this.$refs.addMenu.parentName=t),this.$refs.addMenu.show()},addButtonMenu:function(){this.$refs.addMenu.parentId=this.currentMenu&&this.currentMenu.length>0?this.currentMenu[0]:"",this.$refs.addMenu.show()},queryMenuTree:function(){this.$refs.menuTree.getMenuTreeData()},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},delete:function(e,t){var n=[];n=e?[e]:this.$refs.table.getSelectedRows().map((function(e){return e.userId}));var a=1==t?"停用":"启用",r=this;this.$confirm({content:"确认要删除吗？",onOk:function(){return new Promise((function(e,i){r.onUpdateUserStatus({userIds:n,status:t}),r.$message.success("".concat(a,"成功")),self.destroyAll()})).catch((function(e){return console.log("err"+e)}))},onCancel:function(){console.log("取消停用该部门")}})},edit:function(){console.log("编辑部门人员")},selectIcon:function(){this.$refs.icons.show()},getIcon:function(e){this.menuDetail.icon=e,this.form.setFieldsValue(this.menuDetail)}})}),m=f,p=(n("3ed0"),n("2877")),h=Object(p["a"])(m,a,r,!1,null,"ce0a8efe",null);t["default"]=h.exports},f88a:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Modal",{ref:"modalMenu",attrs:{title:"新建菜单"},on:{ok:e.submit}},[n("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[n("a-form-item",e._b({attrs:{label:"菜单名称"}},"a-form-item",e.formItemLayout,!1),[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["menuName",{rules:[{required:!0,message:"请输入菜单名称"}]}],expression:"[ 'menuName', { rules: [ { required: true, message: '请输入菜单名称', }, ], }, ]"}],attrs:{placeholder:"请输入菜单名称"}})],1),n("a-form-item",e._b({attrs:{label:"上级菜单","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[n("MenuTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentId",{initialValue:e.parentId,rules:[{required:!1,message:"请选择上级上级菜单"}]}],expression:"['parentId', { initialValue: parentId, rules: [{ required: false, message: '请选择上级上级菜单' }], }, ]"}],ref:"MenuTreeSelect",attrs:{selectMenu:e.parentId},on:{change:e.getParentId,getValue:e.getParentId}})],1),n("a-form-item",e._b({attrs:{label:"图标"}},"a-form-item",e.formItemLayout,!1),[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["icon",{rules:[{required:!1}]}],expression:"[ 'icon', { rules: [ { required: false, }, ], }, ]"}],staticStyle:{width:"30%"},attrs:{placeholder:"请选择图标"},on:{click:e.selectIcon}}),e.icon?n("a-icon",{staticStyle:{"margin-left":"10px",color:"#096dd9","font-size":"20px"},attrs:{type:e.icon,theme:"filled"}}):e._e()],1),n("a-form-item",e._b({attrs:{label:"菜单功能"}},"a-form-item",e.formItemLayout,!1),[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["appId",{rules:[{required:!1}]}],expression:"['appId', { rules: [{ required: false }] }]"}],attrs:{allowClear:"","show-search":"","filter-option":e.filterOption,placeholder:"请选择菜单功能"}},e._l(e.appsArr,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.moduleMetaId}},[e._v(" "+e._s(t.moduleTitle)+" ")])})),1)],1)],1)],1),n("Icons",{ref:"icons",on:{getIcon:e.getIcon}})],1)},r=[],i=(n("c975"),n("96cf"),n("1da1")),o=n("5530"),s=n("2f62"),u=n("74c0"),c=n("096e"),l=n("86da"),d={components:{Modal:l["a"],MenuTreeSelect:u["default"],Icons:c["default"]},data:function(){return{parentId:"",parentName:"",visible:!1,autoCompleteResult:[],icon:"",form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:14},sm:{span:5}},wrapperCol:{xs:{span:14},sm:{span:16}}},tailFormItemLayout:{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}}}},props:{title:{type:String,default:"",required:!1}},watch:{parentName:function(e){var t=this;setTimeout((function(){t.form.setFieldsValue({parentName:t.parentName})}),0)}},created:function(){},mounted:function(){var e=this;setTimeout((function(){e.form.setFieldsValue({parentName:e.parentName})}),0)},computed:Object(o["a"])({},Object(s["d"])({userList:function(e){return e.SysUser.pageData.records},appsArr:function(e){return e.SysMenu.appsData}})),methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])({addMenu:"SysMenu/onCreateMenu"})),{},{getParentId:function(e){this.parentId=e},close:function(){this.parentId="",this.$refs.modalMenu.close(),this.form.resetFields()},show:function(){this.$refs.modalMenu.show()},submit:function(){var e=this,t=this,n=this.form.getFieldsValue();n.parentId=this.parentId,this.form.setFieldsValue(n),this.form.validateFieldsAndScroll(function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(a,r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a){n.next=15;break}return n.next=3,t.addMenu(r);case 3:return n.next=5,t.form.resetFields();case 5:return n.next=7,t.$message.success("新建成功");case 7:return n.next=9,t.close();case 9:return n.next=11,t.$emit("menuAddSuccess");case 11:return n.next=13,e.$refs.MenuTreeSelect.setData();case 13:n.next=16;break;case 15:t.pop.loading=!1;case 16:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},selectIcon:function(){this.$refs.icons.show()},getIcon:function(e){this.icon=e;var t=this.form.getFieldsValue();t.icon=this.icon,this.form.setFieldsValue(t)}})},f=d,m=n("2877"),p=Object(m["a"])(f,a,r,!1,null,null,null);t["default"]=p.exports}}]);