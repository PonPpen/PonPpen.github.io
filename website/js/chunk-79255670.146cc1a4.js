(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79255670"],{"1da1":function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));o("d3b7");function r(e,t,o,r,a,n,i){try{var s=e[n](i),l=s.value}catch(c){return void o(c)}s.done?t(l):Promise.resolve(l).then(r,a)}function a(e){return function(){var t=this,o=arguments;return new Promise((function(a,n){var i=e.apply(t,o);function s(e){r(i,a,n,s,l,"next",e)}function l(e){r(i,a,n,s,l,"throw",e)}s(void 0)}))}}},"1e0e":function(e,t,o){"use strict";var r=o("a1b6"),a=o.n(r);a.a},"96cf":function(e,t){!function(t){"use strict";var o,r=Object.prototype,a=r.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag",c="object"===typeof e,u=t.regeneratorRuntime;if(u)c&&(e.exports=u);else{u=t.regeneratorRuntime=c?e.exports:{},u.wrap=b;var d="suspendedStart",h="suspendedYield",p="executing",m="completed",g={},f={};f[i]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(M([])));v&&v!==r&&a.call(v,i)&&(f=v);var w=x.prototype=L.prototype=Object.create(f);S.prototype=w.constructor=x,x.constructor=S,x[l]=S.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(w),e},u.awrap=function(e){return{__await:e}},F(R.prototype),R.prototype[s]=function(){return this},u.AsyncIterator=R,u.async=function(e,t,o,r){var a=new R(b(e,t,o,r));return u.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},F(w),w[l]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){while(t.length){var r=t.pop();if(r in e)return o.value=r,o.done=!1,o}return o.done=!0,o}},u.values=M,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=o)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return s.type="throw",s.arg=e,t.next=r,a&&(t.method="next",t.arg=o),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var n=r;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var i=n?n.completion:{};return i.type=e,i.arg=t,n?(this.method="next",this.next=n.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),C(o),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var r=o.completion;if("throw"===r.type){var a=r.arg;C(o)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:M(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=o),g}}}function b(e,t,o,r){var a=t&&t.prototype instanceof L?t:L,n=Object.create(a.prototype),i=new T(r||[]);return n._invoke=_(e,o,i),n}function k(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(r){return{type:"throw",arg:r}}}function L(){}function S(){}function x(){}function F(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function R(e){function t(o,r,n,i){var s=k(e[o],e,r);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"===typeof c&&a.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,n,i)}),(function(e){t("throw",e,n,i)})):Promise.resolve(c).then((function(e){l.value=e,n(l)}),i)}i(s.arg)}var o;function r(e,r){function a(){return new Promise((function(o,a){t(e,r,o,a)}))}return o=o?o.then(a,a):a()}this._invoke=r}function _(e,t,o){var r=d;return function(a,n){if(r===p)throw new Error("Generator is already running");if(r===m){if("throw"===a)throw n;return D()}o.method=a,o.arg=n;while(1){var i=o.delegate;if(i){var s=j(i,o);if(s){if(s===g)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(r===d)throw r=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=p;var l=k(e,t,o);if("normal"===l.type){if(r=o.done?m:h,l.arg===g)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=m,o.method="throw",o.arg=l.arg)}}}function j(e,t){var r=e.iterator[t.method];if(r===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=o,j(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var a=k(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,g;var n=a.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=o),t.delegate=null,g):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function M(e){if(e){var t=e[i];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){while(++r<e.length)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=o,t.done=!0,t};return n.next=n}}return{next:D}}function D(){return{value:o,done:!0}}}(function(){return this}()||Function("return this")())},a1b6:function(e,t,o){},eaf9:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("PageView",[o("SplitLayout",{attrs:{leftWidth:"240px"}},[o("div",{staticClass:"con-content"},[o("div",{staticClass:"con-content-list",staticStyle:{width:"50%",display:"inline-block"}},[o("div",{staticClass:"header-top myTop",staticStyle:{width:"100%",display:"inline-block"}},[o("div",{staticClass:"topFrom"},[o("a-select",{staticStyle:{width:"35%","margin-right":"5px"},attrs:{placeholder:"选择类型"},on:{change:e.handleChangetop},model:{value:e.searchFromtop.regionType,callback:function(t){e.$set(e.searchFromtop,"regionType",t)},expression:"searchFromtop.regionType"}},e._l(e.regionTypeOption,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t.value.toString()}},[e._v(e._s(t.label))])})),1),o("a-input",{staticStyle:{width:"35%"},attrs:{placeholder:"请输入区域名称"},model:{value:e.searchFromtop.regionName,callback:function(t){e.$set(e.searchFromtop,"regionName",t)},expression:"searchFromtop.regionName"}}),o("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.onQuery,query:e.onQuery}},[e._v("查询")])],1),o("a-button",{staticStyle:{"margin-right":"15px","margin-bottom":"15px"},attrs:{type:"primary"},on:{click:function(t){return e.addRegion({key:3})}}},[e._v("选择高危区域")]),o("a-dropdown",[o("a-button",{staticClass:"ant-dropdown-link",attrs:{type:"primary"},on:{click:function(e){return e.preventDefault()}}},[e._v(" 新增区域 ")]),o("a-menu",{attrs:{slot:"overlay"},on:{click:e.addRegion},slot:"overlay"},[o("a-menu-item",{key:"0"},[e._v(" 地图框选 ")]),o("a-menu-item",{key:"1"},[e._v(" 导入 ")]),o("a-menu-item",{key:"2"},[e._v(" 录入 ")])],1)],1)],1),o("CustomTable",{ref:"table",attrs:{showAlert:!1,columns:e.columns,dataSource:e.sjskRegionResultData,showSelection:!1,loading:e.loading,bordered:""},on:{change:e.onTableChange},scopedSlots:e._u([{key:"num",fn:function(t,o,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"action",fn:function(t){return[o("OperationPermission",{attrs:{check:"privs.item1580050003"}},[o("a",{staticStyle:{"margin-right":"16px"},on:{click:function(o){return e.viewEdit(t)}}},[e._v("编辑")]),o("a",{staticStyle:{"margin-right":"16px"},on:{click:function(o){return e.delData(t)}}},[e._v("删除")])])]}}])})],1),o("div",{staticStyle:{width:"50%",height:"600px",float:"right"},attrs:{id:"viewDiv"}})])]),o("a-modal",{attrs:{title:"位置导入",centered:"",width:"60%"},on:{ok:e.daoruBtn,cancel:e.close},model:{value:e.daoruModal,callback:function(t){e.daoruModal=t},expression:"daoruModal"}},[o("a-form",{attrs:{form:e.form}},[o("a-form-item",{attrs:{label:"区域名称"}},[o("a-input",{staticStyle:{width:"30%"},attrs:{placeholder:"请输入"},model:{value:e.form.regionName,callback:function(t){e.$set(e.form,"regionName",t)},expression:"form.regionName"}})],1),o("a-form-item",{attrs:{label:"区域类型"}},[o("a-select",{staticStyle:{width:"20%","margin-right":"5px"},attrs:{placeholder:"选择类型"},on:{change:e.handleChangeD}},e._l(e.regionTypeOption,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t.value.toString()}},[e._v(e._s(t.label))])})),1)],1),o("a-form-item",{attrs:{label:"导入数据"}},[o("a-upload",{attrs:{name:"file",multiple:!0,headers:this.token,fileList:e.fileListData,beforeUpload:e.beforeUpload,action:e.uploadService},on:{change:e.handleChangeFile}},[o("a-button",[o("a-icon",{attrs:{type:"upload"}}),e._v("上传 ")],1)],1)],1),o("a-form-item",{attrs:{label:"模板下载"}},[o("a-button",{staticStyle:{width:"114px","margin-left":"12px"},attrs:{type:"primary",icon:"download"}},[o("a",{staticStyle:{"margin-left":"12px",color:"white"},attrs:{href:e.downUrl}},[e._v("模板下载")])])],1)],1)],1),o("a-modal",{attrs:{title:"位置录入",centered:"",width:"60%"},on:{ok:e.ruluBtn,cancel:e.close},model:{value:e.ruluModal,callback:function(t){e.ruluModal=t},expression:"ruluModal"}},[e._v(" 区域名称 "),o("a-input",{staticStyle:{width:"20%","margin-right":"10px"},attrs:{placeholder:"请输入区域名称"},model:{value:e.luruForm.regionName,callback:function(t){e.$set(e.luruForm,"regionName",t)},expression:"luruForm.regionName"}}),e._v(" 区域类型 "),o("a-select",{staticStyle:{width:"20%","margin-right":"5px"},attrs:{placeholder:"选择类型"},on:{change:e.handleChangerulu}},e._l(e.regionTypeOption,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t.value.toString()}},[e._v(e._s(t.label))])})),1),o("a-button",{attrs:{type:"primary"},on:{click:e.addPosition}},[e._v("增加位置")]),o("CustomTable",{staticStyle:{"margin-top":"10px"},attrs:{showAlert:!1,columns:e.weizhicolumns,dataSource:e.weizhiData,showSelection:!1,bordered:""},scopedSlots:e._u([{key:"num",fn:function(t,o,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"latitude",fn:function(t,r){return[o("a-input",{model:{value:r.latitude,callback:function(t){e.$set(r,"latitude",t)},expression:"record.latitude"}})]}},{key:"longitude",fn:function(t,r){return[o("a-input",{model:{value:r.longitude,callback:function(t){e.$set(r,"longitude",t)},expression:"record.longitude"}})]}},{key:"position",fn:function(t,r){return[o("a-input",{model:{value:r.position,callback:function(t){e.$set(r,"position",t)},expression:"record.position"}})]}},{key:"action",fn:function(t,r,a){return[o("a",{staticStyle:{"margin-right":"16px"},on:{click:function(t){return e.delrulu(a)}}},[e._v("删除")])]}}])})],1),o("a-modal",{class:{active:e.modalShowactive,noActive:!e.modalShowactive},attrs:{title:e.mapTitle,destroyOnClose:!1,centered:"",width:"70%",confirmLoading:e.btnLoading},on:{ok:e.saveMap,cancel:e.close},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[o("a-form-model",{ref:"ruleForm",attrs:{model:e.queryForm,rules:e.rules,labelCol:{span:8},wrapperCol:{span:16}}},[o("a-row",[o("a-col",{attrs:{span:"6"!==e.queryForm.regionType?7:5}},[o("a-form-model-item",{attrs:{label:"区域名称：",required:"",prop:"regionName"}},[o("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入区域名称"},model:{value:e.queryForm.regionName,callback:function(t){e.$set(e.queryForm,"regionName",t)},expression:"queryForm.regionName"}})],1)],1),o("a-col",{attrs:{span:"6"!==e.queryForm.regionType?7:5}},[o("a-form-model-item",{attrs:{label:"区域类型：",required:"",prop:"regionType"}},[o("a-select",{staticStyle:{width:"100%","margin-right":"5px"},attrs:{placeholder:"选择类型"},on:{change:e.handleChange},model:{value:e.queryForm.regionType,callback:function(t){e.$set(e.queryForm,"regionType",t)},expression:"queryForm.regionType"}},e._l(e.regionTypeOption,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t.value.toString()}},[e._v(e._s(t.label))])})),1)],1)],1),"6"===e.queryForm.regionType?o("a-col",{attrs:{span:5}},[o("a-form-model-item",{attrs:{label:"绑定部门：",required:"",prop:"departmentId"}},[o("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择范围","allow-clear":"",treeData:e.department,allowClear:"",treeDefaultExpandedKeys:e.defaultExpandedKeys},model:{value:e.queryForm.departmentId,callback:function(t){e.$set(e.queryForm,"departmentId",t)},expression:"queryForm.departmentId"}})],1)],1):e._e()],1)],1),o("div",{staticClass:"searchBox"},[o("a-input-search",{attrs:{placeholder:"地区筛选"},on:{search:e.searchAdress},model:{value:e.regionNameAdress,callback:function(t){e.regionNameAdress=t},expression:"regionNameAdress"}},[o("a-button",{attrs:{slot:"enterButton",type:"primary"},slot:"enterButton"},[e._v(" 地区筛选 ")])],1),o("ul",{directives:[{name:"show",rawName:"v-show",value:e.showList,expression:"showList"}],staticStyle:{position:"absolute",top:"33px",left:"-31px",height:"200px","overflow-y":"scroll","z-index":"11111",background:"#fff",border:"1px solid #ddd",width:"300px"}},e._l(e.searchAdressData,(function(t,r){return o("li",{key:r,on:{click:function(o){return e.changeAdress(t)}}},[e._v(" "+e._s(t.properties.NAME)+" ")])})),0),o("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.searchAdressDadian}},[e._v("查询")])],1),o("div",{staticStyle:{width:"100%",height:"600px","margin-top":"10px"},attrs:{id:"modalShowId"}},[o("button",{on:{click:e.drawPolygon}},[e._v("多边形")]),o("button",{on:{click:e.clearLayer}},[e._v("清除")])])],1),o("a-modal",{class:{active:e.choseModalactive,noActive:!e.choseModalactive},attrs:{title:"预设重点区域选择",centered:"",width:"80%"},on:{ok:e.sjskRegionChoose,cancel:e.close},model:{value:e.choseModal,callback:function(t){e.choseModal=t},expression:"choseModal"}},[o("div",[o("div",{staticClass:"leftContent"},[o("a-select",{staticStyle:{width:"20%","margin-right":"5px"},attrs:{placeholder:"选择类型"},on:{change:e.handleChangechoseModal},model:{value:e.searchFromModl.regionType,callback:function(t){e.$set(e.searchFromModl,"regionType",t)},expression:"searchFromModl.regionType"}},e._l(e.regionTypeOption,(function(t,r){return o("a-select-option",{key:r,attrs:{value:t.value.toString()}},[e._v(e._s(t.label))])})),1),o("a-button",{attrs:{type:"primary"},on:{click:e.searchBtn}},[e._v("查询")]),o("div",{staticClass:"con-content",staticStyle:{"margin-top":"10px"}},[o("div",{staticClass:"con-content-list"},[o("CustomTable",{ref:"table",attrs:{showAlert:!1,showSelection:!0,columns:e.columns,rowKey:"id",dataSource:e.sjskRegionResultData1,bordered:""},on:{selectedRow:e.onSelectedRow,change:e.onTableChange1},scopedSlots:e._u([{key:"num",fn:function(t,o,r){return[e._v(" "+e._s(r+1)+" ")]}},{key:"action",fn:function(t){return[o("OperationPermission",{attrs:{check:"privs.item1580050003"}},[o("a",{staticStyle:{"margin-right":"16px"},on:{click:function(o){return e.view(t)}}},[e._v("编辑")]),o("a",{staticStyle:{"margin-right":"16px"},on:{click:function(o){return e.delData(t)}}},[e._v("删除")])])]}}])})],1)])],1),o("div",{staticClass:"rightMap"},[o("div",{staticStyle:{width:"100%",height:"600px"},attrs:{id:"rightMap"}})])])])],1)},a=[],n=(o("4160"),o("d81d"),o("fb6a"),o("a434"),o("b0c0"),o("a9e3"),o("ac1f"),o("5319"),o("1276"),o("159b"),o("b85c")),i=o("5530"),s=(o("96cf"),o("1da1")),l=o("cc33"),c=o("2f62"),u=o("17b5"),d=o("a27e"),h=o("bf11"),p=(o("afaa"),o("5bc0"),o("a2c7")),m=o("5eee"),g=o("4cdf"),f=o("5831"),y=o("3e6b"),v=o("9c78"),w=o("480c"),b=o("f2f0"),k=o("f403"),L=o("6c77"),S=o("8682"),x=o("83a6"),F=o("ce2c"),R=o("256f"),_=o("ac29"),j=o("5bc3"),P=o("f822"),C=o("bc3a"),T=o.n(C),M={name:"keyAreas",components:{CustomTable:h["a"]},data:function(){return{showList:!1,fetching:!1,searchAdressData:[],regionNameAdress:"",regionTypeOption:[{value:"0",label:"全部区域"},{value:"1",label:"自然景区"},{value:"2",label:"休闲娱乐"},{value:"3",label:"重要区域"},{value:"4",label:"学校区域"},{value:"5",label:"交通枢纽"},{value:"6",label:"执行地"}],rules:{regionName:[{required:!0,message:"请输入区域名称"}],regionType:[{required:!0,message:"请选择区域类型"}],departmentId:[{required:!0,message:"请选择绑定部门"}]},modalShowFlag:0,addFlags:0,mapTitle:"地图框选",token:{token:Object(l["e"])()},fileListData:[],idList:[],choseModal:!0,choseModalactive:!1,downUrl:this.$globalConfig.uploadPath+"/api/manage-service/sjskRegion/download",uploadService:this.$globalConfig.uploadPath+"/api/manage-service/sjskRegion/upload",adress:this.$globalConfig.uploadPath+"/hgis/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ktw:PLAPT_ZW&maxFeatures=10&outputFormat=application/json&cql_filter=NAME%20like%20'%25%E9%BE%99%E5%8D%8E%E8%B7%AF%25'",form:{regionName:""},daoruModal:!1,headers:{"Content-Type":"multipart/form-data"},modalShow:!0,modalShowactive:!1,sjskRegionResultData:{},sjskRegionResultData1:{},yearInputVal:"",monthInputVal:"",autoExpandParent:!0,searchVal:"",showLine:!0,showIcon:!1,jingweidu:[],queryForm:{regionName:"",regionType:"0",deptId:"",departmentId:""},searchFromtop:{regionName:"",regionType:"0",currentPage:1,pageSize:10},searchFromModl:{regionName:"",regionType:"0",currentPage:1,pageSize:10},ruluModal:!1,weizhicolumns:[{title:"序号",dataIndex:"num",scopedSlots:{customRender:"num"}},{title:"经度",dataIndex:"latitude",scopedSlots:{customRender:"latitude"}},{title:"纬度",dataIndex:"longitude",scopedSlots:{customRender:"longitude"}},{title:"位置",dataIndex:"position",scopedSlots:{customRender:"position"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],weizhiData:[],luruForm:{regionName:"",regionType:"",sjskPositionParamVOList:[],source:2},columns:[{title:"序号",dataIndex:"num",scopedSlots:{customRender:"num"}},{title:"区域名称",dataIndex:"regionName"},{title:"区域类型",dataIndex:"regionTypeStr"},{title:"来源",dataIndex:"source"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],pageFilter:{currentPage:1,pageSize:10},modules:["esri/Map","esri/WebMap","esri/widgets/Locate","esri/widgets/Track","esri/layers/TileLayer","esri/views/MapView","esri/Graphic","esri/layers/GraphicsLayer","esri/layers/FeatureLayer","esri/PopupTemplate","esri/widgets/Locate","esri/widgets/Track","esri/widgets/Sketch","esri/widgets/Sketch/SketchViewModel","dojo/domReady!"],gisConstructor:{},graphicsLayer:{},coordinateList:[],sketchViewModel:{},isMarquee:!1,map:null,view:null,style:new L["c"]({stroke:new S["a"]({width:4,color:"#119aff"}),fill:new x["a"]({color:"rgba(57,160,255,0.5)"})}),vectorSource:new f["a"]({wrapX:!1}),draw:{},vector:{},map2:null,view2:null,style2:new L["c"]({stroke:new S["a"]({width:4,color:"#119aff"}),fill:new x["a"]({color:"rgba(57,160,255,0.5)"})}),vectorSource2:new f["a"]({wrapX:!1}),draw2:{},vector2:{},map3:null,view3:null,style3:new L["c"]({stroke:new S["a"]({width:4,color:"#119aff"}),fill:new x["a"]({color:"rgba(57,160,255,0.5)"})}),vectorSource3:new f["a"]({wrapX:!1}),draw3:{},vector3:{},regionNameAdressId:"",loading:!1,vectorLayer:{},defaultExpandedKeys:[],department:[],btnLoading:!1}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTree();case 2:e.department=e.treeData.length>0&&e.treeData[0].children.length>0?e.treeData[0].children:e.treeData,e.defaultExpandedKeys=e.department&&e.department.length>0?[e.department[0].key]:[];case 4:case"end":return t.stop()}}),t)})))()},computed:Object(i["a"])({},Object(c["d"])({treeData:function(e){return e.SysDepartment.treeData}})),mounted:function(){this.sjskRegionResults(),this.sjskRegionResults1(),this.loadingMap(),this.loadingMapChoose()},methods:Object(i["a"])(Object(i["a"])({},Object(c["b"])({getTree:"SysDepartment/getTree"})),{},{searchAdress:function(){var e=this;console.log(this.regionNameAdress);var t=this.regionNameAdress,o="http://59.212.202.61:8020/hgis/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=ktw:PLAPT_ZW&maxFeatures=10&outputFormat=application/json&cql_filter=NAME%20like%20%27%25"+t+"%25%27";console.log(t),console.log(o),T.a.get(o).then((function(t){console.log(t),e.searchAdressData=t.data.features,e.showList=!0,console.log(e.searchAdressData)}))},changeAdress:function(e){this.regionNameAdress=e.properties.NAME,this.regionNameAdressId=e.id,this.showList=!1,console.log(e)},handleChangechoseModal:function(){},beforeUpload:function(e){var t=e.size/1024/1024<50;return t||this.$message.error("文件超过50M了"),t},handleChangeFile:function(e){var t=e.file,o=e.fileList;console.log(t.status),"removed"!==t.status&&t.response&&200!==t.response.status?this.$message.error("上传失败，检查服务是否正常或者重新上传"):("removed"===t.status&&(this.fileListData=o,this.fileList=this.fileListMap(this.fileListData)),"uploading"===t.status&&(this.fileListData=o),"done"===t.status&&200===t.response.status&&(this.fileList=this.fileListMap(this.fileListData)))},fileListMap:function(e){var t,o=[],r=Object(n["a"])(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i={};a.response&&200===a.response.status&&(i.name=a.name,i.data=a.response.data[0],o.push(i))}}catch(s){r.e(s)}finally{r.f()}return o},addRegion:function(e){e=e.key,this.queryForm={regionName:"",regionType:"1",sjskPositionParamVOList:[]},0==e&&(this.mapTitle="地图框选",this.addFlags=0,this.modalShow=!0,this.modalShowactive=!0,null!==this.map2&&this.map2.removeLayer(this.vectorLayer),0==this.modalShowFlag&&this.loadingMapModal()),1==e&&(this.daoruModal=!0,this.form={regionName:""},this.fileListData=[]),2==e&&(this.weizhiData=[],this.ruluModal=!0,this.luruForm={regionName:"",regionType:"",sjskPositionParamVOList:[],source:2}),3==e&&(this.choseModal=!0,this.choseModalactive=!0,this.loadingMapChoose())},viewEdit:function(e){var t=this;this.coordinateList.length>0&&this.clearLayer(),this.mapTitle="地图编辑",this.queryForm.regionName=e.regionName,this.queryForm.regionType=e.regionType,this.modalShow=!0,this.modalShowactive=!0,0==this.modalShowFlag&&this.loadingMapModal();var o=this;this.addFlags=1,this.queryForm.id=e.id;var r=[];u["a"].sjskRegionqueryById(e.id).then((function(e){t.queryForm.regionType=e.regionType,t.queryForm.departmentId=e.departmentId,t.queryForm.sjskPositionParamVOList=e.sjskPositionParamVOList,e.sjskPositionParamVOList.forEach((function(e){r.push([Number(e.latitude),Number(e.longitude)])})),t.map2.removeLayer(t.vectorLayer),console.log(r),t.map2.addLayer(o.drawPolygonEdit(r))}))},onSelect:function(e){console.log(e)},onQuery:function(){this.sjskRegionResults()},searchBtn:function(){this.sjskRegionResults1()},sjskRegionResults:function(){var e=this;this.loading=!0,u["a"].sjskRegionResult(this.searchFromtop).then((function(t){e.loading=!1,e.sjskRegionResultData=t}))},sjskRegionResults1:function(){var e=this;u["a"].sjskRegionResult(this.searchFromModl).then((function(t){e.sjskRegionResultData1=t}))},onTableChange:function(e){console.log(e),this.searchFromtop.currentPage=e.currentPage,this.searchFromtop.pageSize=e.pageSize,this.sjskRegionResults()},onTableChange1:function(e){console.log(e),this.searchFromModl.currentPage=e.currentPage,this.searchFromModl.pageSize=e.pageSize,this.sjskRegionResults1()},handleChange:function(e){},handleChangetop:function(e){},group:function(e,t){var o=0,r=[];while(o<e.length)r.push(e.slice(o,o+=t));return r},saveMap:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(o){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!o){t.next=11;break}if(r=e,e.queryForm.source=1,e.coordinateList.length>0&&(e.queryForm.sjskPositionParamVOList=[],e.coordinateList=e.group(e.coordinateList,2),e.coordinateList.forEach((function(t){e.queryForm.sjskPositionParamVOList.push({latitude:t[0],longitude:t[1]})}))),!(e.queryForm.sjskPositionParamVOList.length<=0)){t.next=7;break}return e.$message.warning("请框选区域"),t.abrupt("return");case 7:e.btnLoading=!0,0==e.addFlags?(console.log(e.queryForm),u["a"].sjskRegionadd(e.queryForm).then((function(t){e.modalShow=!1,r.sjskRegionResults(),e.btnLoading=!1}))):u["a"].sjskRegionedit(e.queryForm).then((function(t){e.modalShow=!1,r.sjskRegionResults(),e.btnLoading=!1})),t.next=14;break;case 11:return console.log("error submit!!"),e.btnLoading=!1,t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},delData:function(e){var t=this;this.$confirm({title:"提示",content:"确认删除该区域吗？",onOk:function(){u["a"].sjskRegiondelete(e.id).then((function(e){t.sjskRegionResults()}))},onCancel:function(){}})},downLoadfile:function(){Object(d["a"])({method:"get",url:this.$globalConfig.uploadPath+"/api/zuul/manage-service/sjskRegion/download",responseType:"blob",data:{},headers:{"Content-Type":"multipart/form-data"}}).then((function(e){}))},handleChangeD:function(e){this.form.regionType=e},daoruBtn:function(){var e=this;u["a"].sjskRegionexcelToSave(this.form).then((function(t){e.daoruModal=!1,e.sjskRegionResults()}))},addPosition:function(){this.weizhiData.push({latitude:"",longitude:"",position:""}),console.log(this.weizhiData)},delrulu:function(e){console.log(e),this.weizhiData.splice(e,1)},handleChangerulu:function(e){this.luruForm.regionType=e},ruluBtn:function(){var e=this;this.luruForm.sjskPositionParamVOList=this.weizhiData,u["a"].sjskRegionadd(this.luruForm).then((function(t){e.ruluModal=!1,e.sjskRegionResults()}))},sjskRegionChoose:function(){var e=this;u["a"].sjskRegionchoose(this.idList).then((function(t){e.$message.success("预高危区域选择成功"),e.choseModal=!1}))},onSelectedRow:function(e){console.log(e),this.idList=e},loadingMap:function(){var e=this;this.view=new p["a"]({projection:"EPSG:4326",center:[110.321533,20.036168],zoom:12,minZoom:6}),this.map=new m["a"]({target:document.getElementById("viewDiv"),view:this.view}),this.vector=new y["a"]({source:this.vectorSource,style:this.style}),this.map.addLayer(new v["a"]({layers:this.layerData()})),this.map.addLayer(this.vector),this.map.on("click",(function(t){e.map.forEachFeatureAtPixel(t.pixel,(function(e){return e}))}))},layerData:function(){for(var e=Object(R["g"])("EPSG:4326"),t=(e.getExtent(),1.40625),o=[],r=[],a=0;a<28;a++)r[a]=a,o[a]=t/Math.pow(2,a);var n=[];return n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.PROPL_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.VEGPL_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.HYDPL_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.RESPL_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.RAILN_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.ROALN_ZW)})),n.push(new w["a"]({source:new b["a"](this.$globalConfig.mapConfig.PLAPT_ZW)})),n},loadingMapChoose:function(e){for(var t in e){var o=this.modules[t].split("/").pop();o=o.replace(o[0],o[0].toUpperCase()),this.gisConstructor[o]=e[t]}this.view3=new p["a"]({projection:"EPSG:4326",center:[110.321533,20.036168],zoom:12,minZoom:6}),this.map3=new m["a"]({target:document.getElementById("rightMap"),view:this.view3}),this.vector3=new y["a"]({source:this.vectorSource3,style:this.style3}),this.map3.addLayer(new v["a"]({layers:this.layerData()})),this.map3.addLayer(this.vector3)},drawCircle:function(){var e=this,t=this;this.clearLayer(),this.draw2=new _["a"]({type:"Circle",source:this.vectorSource2,free:!1}),this.map2.addInteraction(this.draw2),this.draw2.on("drawend",(function(o){if(null!=o.feature){e.removeDraw(),console.log(o.feature.getGeometry().getCenter(),o.feature.getGeometry().getRadius());var r=o.feature.getGeometry().getCenter(),a=[o.feature.getGeometry().getRadius(),o.feature.getGeometry().getRadius()];t.coordinateList=[r[0],r[1],a[0],a[1]],console.log(t.coordinateList),console.log(o.feature.getGeometry().getFlatCoordinates())}}),this)},drawPolygon:function(){var e=this,t=this;this.clearLayer(),this.draw2=new _["a"]({type:"Polygon",source:this.vectorSource2,free:!1}),this.map2.addInteraction(this.draw2),this.draw2.on("drawend",(function(o){null!=o.feature&&(e.removeDraw(),t.coordinateList=o.feature.getGeometry().getFlatCoordinates(),console.log(t.coordinateList))}),this)},removeDraw:function(){this.map2.removeInteraction(this.draw2)},clearLayer:function(){this.coordinateList=[],this.queryForm.sjskPositionParamVOList=[],this.vector2.getSource().clear(),null!==this.map2&&this.map2.removeLayer(this.vectorLayer)},transPoint:function(e){var t=e.split(",");t=[parseFloat(t[0]),parseFloat(t[1])];var o=Object(R["d"])(t,"EPSG:4326","EPSG:3857");return o},drawPolygonEdit:function(e){var t=new f["a"],o="";o=2==e.length?new g["a"]({geometry:new P["a"](e[0],e[1][0])}):new g["a"]({geometry:new j["a"]([e])});var r=[new L["c"]({stroke:new S["a"]({color:"red",width:2})})];o.setStyle(r),t.addFeature(o);var a=new y["a"]({title:"equipment",source:t});return this.vectorLayer=a,a},searchAdressDadian:function(){alert(2);for(var e=[],t=0;t<this.searchAdressData.length;t++)if(this.searchAdressData[t].id==this.regionNameAdressId)return e=[[this.searchAdressData[t].properties.LON,this.searchAdressData[t].properties.LAT]],void this.drawPoint(e)},drawPoint:function(e){console.log(e);var t=new f["a"];this.coordinatesData=[[110.320042,20.035132],[110.321533,20.036168],[110.320042,20.035132],[110.321533,20.036168]],e.forEach((function(e){var o=new g["a"]({geometry:new k["a"](e)}),r=[new L["c"]({image:new F["a"]({fill:new x["a"]({color:"#3399CC"}),stroke:new S["a"]({color:"#ffffff",width:1.25}),radius:5})})];o.setStyle(r),t.addFeature(o)}));var o=new y["a"]({title:"equipment",source:t});this.map2.addLayer(o)},loadingMapModal:function(e){for(var t in e){var o=this.modules[t].split("/").pop();o=o.replace(o[0],o[0].toUpperCase()),this.gisConstructor[o]=e[t]}this.view2=new p["a"]({projection:"EPSG:4326",center:[110.320042,20.035132],zoom:12,minZoom:6}),this.map2=new m["a"]({target:document.getElementById("modalShowId"),view:this.view2}),this.vector2=new y["a"]({source:this.vectorSource2,style:this.style2}),this.map2.addLayer(new v["a"]({layers:this.layerData()})),this.map2.addLayer(this.vector2),this.modalShowFlag=1},clearArea:function(){this.coordinateList=[],this.isMarquee=!1,this.clearLayer()},getdata:function(e){var t=this;e.forEach((function(e){e.longitude,e.latitude;var o=new f["a"],r=new y["a"]({title:"equipment",source:o});t.map.addLayer(r)}))},close:function(){console.log("关闭",this.modalShow,this.choseModal),setTimeout((function(){document.querySelector("body").setAttribute("style","")}),1e3)}})},D=M,E=(o("1e0e"),o("2877")),N=Object(E["a"])(D,r,a,!1,null,"b1bd335a",null);t["default"]=N.exports}}]);