(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-543d90f8","chunk-2d0d0177","chunk-2d225828"],{1426:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"新增部门",visible:e.visible},on:{ok:e.submit,close:e.close}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",e._b({attrs:{label:"机构类型"}},"a-form-item",e.formItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptType",{rules:[{required:!0,message:"请选择机构类型"}]}],expression:"['deptType',{ rules: [ { required: true, message: '请选择机构类型' } ] } ]"}],attrs:{placeholder:"请选择机构类型"}},e._l(e.deptTypeData,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-item",e._b({attrs:{label:"部门名称"}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptName",{rules:[{required:!0,message:"请输入部门名称"}]}],expression:"[ 'deptName', { rules: [ { required: true, message: '请输入部门名称', }, ], }, ]"}],attrs:{placeholder:"请输入部门名称"}})],1),a("a-form-item",e._b({attrs:{label:"上级部门","has-feedback":""}},"a-form-item",e.formItemLayout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["parentName",{initialValue:e.parentName,rules:[{required:!0,message:"填写上级部门名称"}]}],expression:"[ 'parentName', { initialValue: parentName, rules: [{ required: true, message: '填写上级部门名称' }], }, ]"}],attrs:{disabled:!0,placeholder:"请选择上级部门"}})],1),a("a-form-item",e._b({attrs:{label:"负责人"}},"a-form-item",e.formItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["leader",{rules:[{required:!1}]}],expression:"['leader', { rules: [{ required: false }] }]"}],attrs:{placeholder:"请选择部门负责人"}},e._l(e.roleUserListData,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.userId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1)},n=[],s=(a("c975"),a("4d63"),a("ac1f"),a("25f0"),a("96cf"),a("1da1")),o=a("5530"),i=a("2f62"),c=a("86da"),l={name:"Department",components:{Modal:c["a"]},data:function(){return{visible:!1,autoCompleteResult:[],form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},tailFormItemLayout:{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}}}},props:{title:{type:String,default:"",required:!1},parentId:{type:String,required:!0},parentName:{type:String,required:!0},deptTypeData:{type:Array,default:function(){return[]},required:!0},areaCodeData:{type:Array,default:function(){return[]},required:!0}},watch:{visible:function(e){this.$refs.modal.visible=e},parentName:function(e){this.form.setFieldsValue({parentName:this.parentName})}},created:function(){this.onGetUserList()},mounted:function(){this.form.setFieldsValue({parentName:this.parentName})},computed:Object(o["a"])({},Object(i["d"])({userList:function(e){return e.SysUser.userList},roleUserListData:function(e){return e.SysUser.roleUserListData}})),methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])({addDep:"SysDepartment/onCreate",getUserList:"SysUser/OnGetUserList",onRoleUserList:"SysUser/onRoleUserList"})),{},{phoneValidata:function(e,t,a){var r=new RegExp(/^1[3456789]\d{9}$/);t&&r.test(t)?a("当前联系方式不符合规范，请重新填写!"):a()},onGetUserList:function(){this.onRoleUserList({})},close:function(){this.form.resetFields(),this.visible=!1},submit:function(){var e=this,t=this;this.form.validateFieldsAndScroll(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(r,n){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r){a.next=10;break}return-1==t.parentId.indexOf("tenant")?n.parentId=e.parentId:n.parentId=0,a.next=4,t.addDep(n);case 4:return a.next=6,t.$message.success("新建成功");case 6:setTimeout((function(){t.$emit("depAddSuccess")}),500),t.visible=!1,a.next=11;break;case 10:t.pop.loading=!1;case 11:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}})},u=l,d=a("2877"),p=Object(d["a"])(u,r,n,!1,null,null,null);t["default"]=p.exports},"4e0b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageView",[a("SplitLayout",{attrs:{leftWidth:"240px"}},[a("div",{staticClass:"tree-container",attrs:{slot:"left"},slot:"left"},[a("div",{staticClass:"no-set-box"},[e.noDepUserList.total>0?a("div",{staticClass:"no-set-box-item",on:{click:function(t){return e.changeTableShow("noDepUserTable")}}},[e._v(" "+e._s(e.noDepUserList.total)+"名员工未分配主属部门 ")]):e._e()]),a("dep-tree",{ref:"depTree",on:{editDep:e.editDep,selectDep:e.queryDepUser,addDep:e.addDep,changeStatus:e.changeStatus}})],1),a("div",["userTable"==e.tableShow?a("div",{staticClass:"tool-bar"},[a("div",{staticClass:"userTableTitle"},[e._v(" 部门："+e._s(e.currentDepName)+" "),e._v(" "+e._s(""==e.currentDepLeaderName?"":" | 领导人: "+e.currentDepLeaderName)+" ")]),a("div",{staticClass:"handleBox"},[a("div",{staticClass:"userButton"},[a("OperationPermission",{attrs:{check:"privs.item1180000007"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.addUserShow}},[e._v("新增用户")])],1),a("OperationPermission",{attrs:{check:"privs.item1180000014"}},[a("a-button",{attrs:{disabled:this.$refs.table&&!this.$refs.table.getSelectedRowKeys().length},on:{click:function(t){return e.resetPassword("batch",null)}}},[e._v("重置密码")])],1),a("OperationPermission",{attrs:{check:"privs.item1180000015"}},[a("a-button",{attrs:{disabled:this.$refs.table&&!this.$refs.table.getSelectedRowKeys().length},on:{click:function(t){return e.translateDep("batch",null)}}},[e._v("转移部门")])],1),a("OperationPermission",{attrs:{check:"privs.item1180000016"}},[a("a-button",{attrs:{disabled:this.$refs.table&&!this.$refs.table.getSelectedRowKeys().length},on:{click:function(t){return e.changeUserStatus(null,1)}}},[e._v("停用")])],1),a("OperationPermission",{attrs:{check:"privs.item1180000017"}},[a("a-button",{attrs:{disabled:this.$refs.table&&!this.$refs.table.getSelectedRowKeys().length},on:{click:function(t){return e.changeUserStatus(null,0)}}},[e._v("启用")])],1)],1),a("div",[a("a-input-group",{attrs:{compact:""}},[a("a-select",{staticStyle:{width:"130px"},on:{change:e.handleChange},model:{value:e.searchFormModel,callback:function(t){e.searchFormModel=t},expression:"searchFormModel"}},[a("a-select-option",{attrs:{value:1}},[e._v(" 按姓名搜索 ")]),a("a-select-option",{attrs:{value:2}},[e._v(" 按账号搜索 ")]),a("a-select-option",{attrs:{value:3}},[e._v(" 按手机号搜索 ")])],1),1===e.searchFormModel?a("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:"输入姓名查询用户",allowClear:""},on:{search:e.queryTable},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}}):e._e(),2===e.searchFormModel?a("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:"输入个人账号查询用户",allowClear:""},on:{search:e.queryTable},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}}):e._e(),3===e.searchFormModel?a("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:"输入手机号查询用户",allowClear:""},on:{search:e.queryTable},model:{value:e.searchForm.phone,callback:function(t){e.$set(e.searchForm,"phone",t)},expression:"searchForm.phone"}}):e._e()],1)],1)])]):e._e(),"userTable"===e.tableShow?a("div",{attrs:{id:"userTable"}},[a("CustomTable",{ref:"table",attrs:{rowKey:"userId",showSelection:!0,loading:e.loading.page,columns:e.columns,dataSource:e.pageData,onChange:e.onTableChange},scopedSlots:e._u([{key:"jobName",fn:function(t){return[e._v(" "+e._s(e.fifleDictionary(t,"name"))+" ")]}},{key:"status",fn:function(t){return[a("a-badge",{attrs:{status:0===t?"success":"error"}}),e._v(" "+e._s(0===t?"使用中":"停用")+" ")]}},{key:"subDept",fn:function(t){return[a("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"inline-block",width:"80px"},attrs:{title:t}},[e._v(" "+e._s(t)+" ")])]}},{key:"action",fn:function(t){return[a("OperationPermission",{attrs:{check:"privs.item1180000008"}},[a("a",{staticClass:"table-action-btn",on:{click:function(a){return e.userEdit(t,a)}}},[e._v("编辑")])]),a("OperationPermission",{attrs:{check:"privs.item1180000012"}},[a("a",{staticClass:"table-action-btn",on:{click:function(a){return e.changeUserStatus(t,1==t.status?0:1,a)}}},[e._v(e._s(1==t.status?"启用":"停用"))])]),a("OperationPermission",{attrs:{check:"privs.item1180000011"}},[a("a",{staticClass:"table-action-btn",on:{click:function(a){return e.translateDep("single",t,a)}}},[e._v("转移部门")])]),a("br"),a("OperationPermission",{attrs:{check:"privs.item1180000010"}},[a("a",{staticClass:"table-action-btn",on:{click:function(a){return e.resetPassword("single",t,a)}}},[e._v("重置密码")])]),a("OperationPermission",{attrs:{check:"privs.item1180000010"}},[a("a",{staticClass:"table-action-btn",on:{click:function(a){return e.unlockAccount(t,a)}}},[e._v("账户解锁")])])]}}],null,!1,2061102450)})],1):e._e(),"noLeaderDepTable"===e.tableShow?a("div",{attrs:{id:"noLeaderDepTable"}},[a("CustomTable",{ref:"noLeaderDepTable",attrs:{showAlert:!1,showSelection:!1,loading:e.loading.noLeaderDepTableLoading,columns:e.noleaderDepColums,dataSource:e.noLeaderDepList,onChange:e.onNoLeaderDepTableChange},scopedSlots:e._u([{key:"createTime",fn:function(t){return[e._v(" "+e._s(e.moment(t).format("YYYY-MM-DD hh:mm:ss"))+" ")]}},{key:"action",fn:function(t){return[a("a",{on:{click:function(a){return e.selectDepLeader(t)}}},[e._v("选择部门负责人")])]}}],null,!1,1184271681)})],1):e._e(),"noDepUserTable"===e.tableShow?a("div",{attrs:{id:"noDepUserTable"}},[a("CustomTable",{ref:"noDepUserTable",attrs:{showAlert:!1,showSelection:!1,loading:e.loading.noDepUserLoading,columns:e.noDepUserColums,dataSource:e.noDepUserList.records,onChange:e.onNoDepUserTableChange},scopedSlots:e._u([{key:"jobName",fn:function(t){return[e._v(" "+e._s(e.fifleDictionary(t,"name"))+" ")]}},{key:"action",fn:function(t){return[a("a",{on:{click:function(a){return e.selectDep(t)}}},[e._v("选择主属部门")])]}}],null,!1,996712903)})],1):e._e(),a("DepLeaderSelect",{ref:"depLeaderSelect",on:{depSelectLeaderSuccess:e.getDepNoLeader}}),a("AddDep",{ref:"addDep",attrs:{deptTypeData:e.deptTypeData,areaCodeData:e.areaCodeData,parentId:e.parentId,parentName:e.parentName},on:{depAddSuccess:e.queryDepTree}}),a("DepEdit",{ref:"depEdit",attrs:{deptTypeData:e.deptTypeData,areaCodeData:e.areaCodeData},on:{depAddSuccess:e.queryDepTree}}),a("DepSelect",{ref:"depSelect",on:{depSelectSuccess:e.getNoDepUser}}),a("TranslateDep",{ref:"translateDep",on:{tranDepSuccess:e.tranDepSuccess}}),a("ResetPassword",{ref:"resetPassword"})],1)])],1)},n=[],s=(a("4de4"),a("c975"),a("d81d"),a("fb6a"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("5530")),o=(a("96cf"),a("1da1")),i=a("2f62"),c=a("cc33"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dep-tree"}},[e.loadingBool?e._e():a("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"请输入搜索内容"},on:{change:e.onChange},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e.loadingBool?a("a-skeleton",{attrs:{active:"",paragraph:{rows:12}}}):a("a-tree",{attrs:{treeData:e.treeData,showLine:!0,selectedKeys:e.selectKey,expandedKeys:e.expandedKeys,defaultExpandAll:e.defaultExpandAll,autoExpandParent:e.autoExpandParent},on:{expand:e.onExpand,select:e.selectNode},scopedSlots:e._u([{key:"custom",fn:function(t){return[t.title.indexOf(e.searchValue)>-1?a("span",[a("div",{class:1==t.status?"depStop tree-title":"tree-title",attrs:{title:t.title}},[e._v(" "+e._s(t.title.substr(0,t.title.indexOf(e.searchValue)))+" "),a("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(t.title.substr(t.title.indexOf(e.searchValue)+e.searchValue.length))+" "+e._s(1==t.status?"(停用)":"")+" ")]),a("div",{staticClass:"tree-todo"},[a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v("操作"),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"0"},[a("a",{attrs:{target:"_blank",rel:"noopener noreferrer"},on:{click:function(a){return e.addDep(t.key,t.title)}}},[e._v("新建下级部门")])]),-1===t.key.indexOf("tenant")?a("a-menu-item",{key:"1"},[a("a",{style:{cursor:t.key.indexOf("tenant")>-1?"not-allowed":"pointer"},attrs:{target:"_blank",rel:"noopener noreferrer"},on:{click:function(a){return e.addDep(t.parentId,t.parentName,t.key)}}},[e._v("新建同级部门")])]):e._e(),-1===t.key.indexOf("tenant")?a("a-menu-item",{key:"3",attrs:{target:"_blank"},on:{click:function(a){return e.editDep(t)}}},[e._v("编辑")]):e._e(),-1===t.key.indexOf("tenant")?a("a-menu-item",{key:"4",attrs:{target:"_blank"},on:{click:function(a){return e.changeStatus(t)}}},[e._v(e._s(1==t.status?"启用":"停用"))]):e._e()],1)],1)],1)]):a("span",[e._v(e._s(t.title))])]}}],null,!1,2493901683)})],1)},u=[],d=function e(t,a,r){for(var n=0;n<t.length;n++)t[n].scopedSlots={title:"custom"},a&&(t[n].parentId=a,t[n].parentName=r),t[n].children.length>0&&e(t[n].children,t[n].key,t[n].title);return t},p={name:"depTree",props:{defaultExpandAll:{type:Boolean,default:!1}},data:function(){return{expandedKeys:[],autoExpandParent:!0,dataList:[],treeData:[],selectKey:[],confirmVisible:{},itemIndex:"",searchValue:"",loadingBool:!1,depSearch:{searchName:""}}},computed:Object(s["a"])({},Object(i["d"])({loading:function(e){return e.SysDepartment.loading},streeData:function(e){var t=e.SysDepartment.treeData,a=JSON.parse(JSON.stringify(t));return d(a)}})),watch:{streeData:function(e){this.treeData=JSON.parse(JSON.stringify(e))}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadingBool=!0,t.next=3,e.getDepTree();case 3:a=t.sent,a&&(r=a[0],e.selectKey=[r.key],e.expandedKeys=[r.key],e.generateList(a),e.$emit("selectDep",r.key,r.title),e.loadingBool=!1);case 5:case"end":return t.stop()}}),t)})))()},methods:Object(s["a"])(Object(s["a"])({},Object(i["b"])({getDepTree:"SysDepartment/getTree"})),{},{onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},generateList:function(e){for(var t=0;t<e.length;t++){var a=e[t];this.dataList.push({key:a.key,parentId:a.parentId,extendData:a.extendData,title:a.title}),a.children&&this.generateList(a.children)}},onChange:function(e){var t=this,a=e.target.value;""!=a?a&&this.dataList.map((function(e){e.title.indexOf(a)>-1&&(t.expandedKeys=e.extendData.substring(0,e.extendData.length-1).split(","))})):this.expandedKeys=[this.treeData[0].key]},selectNode:function(e,t){this.selectKey=e;var a=t.selectedNodes[0].data.props.dataRef.title;e&&e.length>0&&this.$emit("selectDep",e[0],a)},addDep:function(e,t,a){a&&a.indexOf("tenant")>-1||(this.$emit("addDep",e,t),console.log(e,t))},editDep:function(e){this.$emit("editDep",e)},changeStatus:function(e){var t=e.key,a=e.status;this.$emit("changeStatus",t,a)},getDepTreeData:function(){var e=this;this.dataList=[],this.getDepTree(this.depSearch).then((function(t){e.generateList(t)}))}})},m=p,f=(a("d2b6"),a("2877")),h=Object(f["a"])(m,l,u,!1,null,"55645df3",null),b=h.exports,D=a("6700"),g=a("b57a"),v=a("e568"),y=a("1426"),S=a("23ff"),w=a("bc97"),x={name:"Department",components:{DepEdit:S["default"],DepTree:b,AddDep:y["default"],DepLeaderSelect:D["default"],DepSelect:g["default"],ResetPassword:v["default"],TranslateDep:w["default"]},data:function(){return{currentDepName:"",currentDepLeaderName:"",currentDep:"",parentName:"",parentId:"",tableShow:"userTable",searchForm:{deptId:"",name:"",phone:""},searchFormModel:1,userTableTitle:"",columns:[{title:"姓名",dataIndex:"name",align:"center",width:"80px"},{title:"个人账号",align:"center",width:"80px",dataIndex:"username"},{title:"主属部门",sorter:!0,align:"center",width:"80px",dataIndex:"mainDept"},{title:"附属部门",dataIndex:"subDept",align:"center",width:"80px",scopedSlots:{customRender:"subDept"}},{title:"职位",dataIndex:"jobName",align:"center",width:"100px",scopedSlots:{customRender:"jobName"}},{title:"联系方式",align:"center",width:"100px",dataIndex:"phone"},{title:"状态",sorter:!0,align:"center",width:"100px",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",width:"250px",align:"center",scopedSlots:{customRender:"action"}}],pageFilter:{},depSearch:{},noleaderDepColums:[{title:"部门名称",dataIndex:"deptName"},{title:"上级部门",dataIndex:"parentName"},{title:"创建时间",dataIndex:"createTime",scopedSlots:{customRender:"createTime"}},{title:"操作",width:"200px",align:"center",scopedSlots:{customRender:"action"}}],noleaderDepSearch:{searchName:""},noleaderDepPageFilter:{},noDepUserColums:[{title:"姓名",dataIndex:"name"},{title:"职位",dataIndex:"jobName",scopedSlots:{customRender:"jobName"}},{title:"联系方式",dataIndex:"phone"},{title:"操作",width:"200px",align:"center",scopedSlots:{customRender:"action"}}],noDepUserSearch:{name:""},noDepUserPageFilter:{},deptTypeData:[],areaCodeData:[],postDictionary:[]}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dataDictionary(),e.getDepNoLeader(),e.getNoDepUser(),e.onPage({currentPage:1,pageSize:9999});case 4:case"end":return t.stop()}}),t)})))()},mounted:function(){},computed:Object(s["a"])({},Object(i["d"])({loading:function(e){return e.SysDepartment.loading},pageData:function(e){return e.SysDepartment.pageData},depDetail:function(e){return e.SysDepartment.userDetail},noLeaderDepList:function(e){return e.SysDepartment.noLeaderDepList},noDepUserList:function(e){return e.SysDepartment.noDepUserList},userList:function(e){return e.SysUser.pageData.records},rootId:function(e){var t=e.SysDepartment.treeData[0].key;return t.slice(t.length-1,t.length)}})),watch:{},methods:Object(s["a"])(Object(s["a"])({},Object(i["b"])({onArea:"SysDictionary/onArea",onChildDictionary:"SysDictionary/onChildDictionary",getUserByDep:"SysDepartment/getUserByDep",getDepNotLeader:"SysDepartment/onGetDepNotLeader",onPage:"SysUser/onPage",onChangeDepStatus:"SysDepartment/onChangeDepStatus",onGetNoDepUserList:"SysDepartment/onGetNoDepUserList",onResetPassword:"SysUser/onResetPassword",onUnlockAccount:"SysUser/onUnlockAccount",getDepTree:"SysDepartment/getTree",onUpdateUserStatus:"SysUser/onUpdateStatus",depDetailGet:"SysDepartment/onGetDepDetail"})),{},{dataDictionary:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.onChildDictionary({parentId:"142"});case 2:return e.deptTypeData=t.sent,a=Object(c["f"])().tenantId,t.next=6,e.onChildDictionary({majorKey:a+"_POSITION"});case 6:e.postDictionary=t.sent;case 7:case"end":return t.stop()}}),t)})))()},fifleDictionary:function(e,t){if(!e)return e;var a=this.postDictionary.filter((function(t){return e.indexOf(t.value)>-1}));return a.length>0?a[0][t]:void 0},tranDepSuccess:function(){this.getUserTable(this.searchForm)},userEdit:function(e,t){console.log(e),t&&t.stopPropagation(),this.pushRouter({userId:e.userId})},editDep:function(e){this.$refs.depEdit.show(),this.$refs.depEdit.depId=e.key,this.$refs.depEdit.depDetailGet(e.key)},addDep:function(e,t){this.parentId=e,this.parentName=t,this.$refs.addDep.visible=!0},resetDepUser:function(){this.searchForm.name="",this.searchForm.phone="",this.getUserTable(this.searchForm)},queryDepUser:function(e,t){var a=this;this.tableShow="userTable",e.indexOf("tenant")>-1?(this.currentDepName=t,this.currentDepLeaderName="",this.currentDep={tenantId:+e.split("_")[1]},this.searchForm={tenantId:+e.split("_")[1]},this.getUserTable({tenantId:+e.split("_")[1]})):(this.depDetailGet(e).then((function(e){a.currentDepName=t,a.currentDepLeaderName=e.leaderName})),this.currentDep={deptId:e},this.searchForm={deptId:e},this.searchForm.deptId=e,this.getUserTable({deptId:e}))},updateUserSuccess:function(){this.getUserTable(this.currentDep)},addSuccess:function(){this.searchForm.deptId&&this.getUserTable(this.searchForm)},handleChange:function(e){1===e?(this.searchForm.phone="",this.searchForm.username=""):2===e?(this.searchForm.name="",this.searchForm.phone=""):3===e&&(this.searchForm.name="",this.searchForm.username="")},queryTable:function(){this.getUserTable(this.searchForm)},getUserTable:function(e){this.getUserByDep(Object(s["a"])(Object(s["a"])({},e),this.pageFilter))},userTableClick:function(e){this.pushRouter({userId:e.userId,detailed:!0})},queryDepTree:function(){this.$refs.depTree.getDepTreeData()},resetDepNoLeader:function(){this.noleaderDepSearch.searchName="",this.getDepNoLeader()},getDepNoLeader:function(){this.getDepNotLeader(this.depSearch)},resetNoDepUser:function(){this.noDepUserSearch.name="",this.getNoDepUser()},getNoDepUser:function(){this.onGetNoDepUserList(this.noDepUserSearch)},onNoLeaderDepTableChange:function(e){this.noLeaderDeppageFilter=e,this.getDepNotLeader(Object(s["a"])(Object(s["a"])({},this.noleaderDepSearch),this.noLeaderDeppageFilter))},onNoDepUserTableChange:function(e){this.noDepUserPageFilter=e,this.getDepNotLeader(Object(s["a"])(Object(s["a"])({},this.noDepUserSearch),this.noDepUserPageFilter))},selectDep:function(e){this.$refs.depSelect.visible=!0,this.$refs.depSelect.userInfo=e},selectDepLeader:function(e){this.$refs.depLeaderSelect.visible=!0,this.$refs.depLeaderSelect.depInfo=e},addUserShow:function(){var e=this.currentDep.deptId,t={};this.currentDep.deptId?(e=this.currentDep.deptId,t.deptId=e):e="",this.pushRouter(t)},changeTableShow:function(e){this.tableShow=e},onTableChange:function(e){this.pageFilter=e,this.getUserTable(this.searchForm)},resetPassword:function(e,t,a){var r=[],n=[];a&&a.stopPropagation(),"batch"==e?(r=this.$refs.table.getSelectedRows().map((function(e){return e.userId})),n=this.$refs.table.getSelectedRows().map((function(e){return e.name}))):(r=[t.userId],n=[t.name]),this.passwordConfirm(r,n)},changeUserStatus:function(e,t,a){if(a&&a.stopPropagation(),!e||t!=e.status){var r=[];r=e?[e.userId]:this.$refs.table.getSelectedRows().map((function(e){return e.userId}));var n=1==t?"停用":"启用",s=this;this.$confirm({content:"确认".concat(n,"？"),onOk:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.onUpdateUserStatus({userIds:r,status:t});case 2:a=e.sent,a&&(console.log(a),s.$message.success("".concat(n,"成功")),s.getUserTable(s.currentDep));case 4:case"end":return e.stop()}}),e)})))()},onCancel:function(){console.log("取消停用该部门")}})}},changeStatus:function(e,t){var a=1==t?0:1,r=1==t?"启用":"停用",n=this;this.$confirm({content:"确认".concat(r,"该部门？"),onOk:function(){return Object(o["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.onChangeDepStatus({deptId:e,status:a});case 2:s=t.sent,s&&(n.$message.success("".concat(r,"成功")),n.queryDepTree());case 4:case"end":return t.stop()}}),t)})))()},onCancel:function(){console.log("取消停用该部门")}})},edit:function(){console.log("编辑部门人员")},translateDep:function(e,t,a){a&&a.stopPropagation();var r=[];r=t?[t.userId]:this.$refs.table.getSelectedRows().map((function(e){return e.userId})),this.$refs.translateDep.show(),this.$refs.translateDep.userIds=r},unlockAccount:function(e,t){t&&t.stopPropagation(),this.unlockConfirm(e.userId,e.name)},passwordConfirm:function(e,t){this.$createElement;var a=this,r={password:"aa123456",userIds:e};this.$confirm({title:"是否对"+t.toString()+"重置密码？",content:function(e){return e("div",{style:"color:red;"},["重置后不可恢复"])},okText:"是",cancelText:"否",onOk:function(){a.onResetPassword(r).then((function(e){e&&e.data&&200===e.status&&a.$message.success("用户密码已重置成功！默认密码："+r.password)})).catch((function(e){console.log(e)}))},onCancel:function(){console.log("Cancel")}})},unlockConfirm:function(e,t){var a=this;this.$confirm({title:"是否对"+t+"账户解锁？",okText:"是",cancelText:"否",onOk:function(){a.onUnlockAccount(e).then((function(e){console.log(e),e&&e.data&&200===e.status&&a.$message.success(e.data)})).catch((function(e){console.log(e)}))},onCancel:function(){console.log("Cancel")}})},pushRouter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$router.push({path:"/organization/newUsers",query:e})}})},k=x,I=(a("5734"),Object(f["a"])(k,r,n,!1,null,"a0da99b8",null));t["default"]=I.exports},5734:function(e,t,a){"use strict";var r=a("da6e"),n=a.n(r);n.a},"5fc1":function(e,t,a){},6700:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"选择部门负责人",visible:e.visible},on:{ok:e.submit,close:e.close}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",e._b({attrs:{label:"部门负责人"}},"a-form-item",e.formItemLayout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["leader",{rules:[{required:!1}]}],expression:"['leader', { rules: [{ required: false }] }]"}],attrs:{placeholder:"请选择部门负责人"}},e._l(e.userList,(function(t,r){return a("a-select-option",{key:"user"+r,attrs:{value:t.userId}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1)},n=[],s=a("5530"),o=a("2f62"),i=a("86da"),c={name:"Department",components:{Modal:i["a"]},data:function(){return{depInfo:{},visible:!1,form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}}},props:{},watch:{visible:function(e){this.$refs.modal.visible=e}},created:function(){},mounted:function(){},computed:Object(s["a"])({},Object(o["d"])({userList:function(e){return e.SysUser.pageData.records}})),methods:Object(s["a"])(Object(s["a"])({},Object(o["b"])({addDep:"SysDepartment/onUpdate"})),{},{close:function(){this.form.resetFields(),this.visible=!1},submit:function(){var e=this,t=this;this.form.validateFieldsAndScroll((function(a,r){if(a)e.pop.loading=!1;else{var n=e.depInfo;n.leader=r.leader,e.addDep(n),t.form.resetFields(),e.$message.success("修改成功"),e.$emit("depSelectLeaderSuccess"),e.visible=!1}}))}})},l=c,u=a("2877"),d=Object(u["a"])(l,r,n,!1,null,null,null);t["default"]=d.exports},b57a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"选择主属部门",visible:e.visible},on:{ok:e.submit,close:e.close}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",e._b({attrs:{label:"主属部门"}},"a-form-item",e.formItemLayout,!1),[a("DepTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["mainDeptIds",{rules:[{required:!0,message:"请选择主属部门"}]}],expression:"[\n          'mainDeptIds',\n          {\n            rules: [\n              {\n                required: true,\n                message: '请选择主属部门',\n              },\n            ],\n          },\n        ]"}],on:{getValue:e.getMainDep}})],1)],1)],1)},n=[],s=(a("96cf"),a("1da1")),o=a("5530"),i=a("2f62"),c=a("86da"),l=a("7174"),u={name:"Department",components:{Modal:c["a"],DepTreeSelect:l["a"]},data:function(){return{mainDep:"",userInfo:{},visible:!1,form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}}},props:{},watch:{visible:function(e){this.$refs.modal.visible=e}},created:function(){},mounted:function(){},computed:{},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])({onUpdate:"SysUser/onUpdate",onDistributionMainDept:"SysUser/onDistributionMainDept"})),{},{getMainDep:function(e){this.mainDep=e},close:function(){this.form.resetFields(),this.visible=!1},submit:function(){var e=this,t=this.form.getFieldsValue();t.mainDeptIds=this.mainDep,this.form.setFieldsValue(t),this.form.validateFieldsAndScroll(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=10;break}return n={},n.userId=e.userInfo.userId,n.mainDeptId=r.mainDeptIds,t.next=6,e.onDistributionMainDept(n);case 6:s=t.sent,s&&(e.form.resetFields(),e.$message.success("修改成功"),e.$emit("depSelectSuccess"),e.visible=!1),t.next=11;break;case 10:e.pop.loading=!1;case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}})},d=u,p=a("2877"),m=Object(p["a"])(d,r,n,!1,null,null,null);t["default"]=m.exports},bc97:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"转移部门"},on:{ok:e.submit,close:e.close}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",e._b({attrs:{label:"转移主属部门"}},"a-form-item",e.formItemLayout,!1),[a("DepTreeSelect",{directives:[{name:"decorator",rawName:"v-decorator",value:["deptId",{rules:[{required:!0,message:"请选择主属部门"}]}],expression:"[\n          'deptId',\n          {\n            rules: [\n              {\n                required: true,\n                message: '请选择主属部门',\n              },\n            ],\n          },\n        ]"}],ref:"depTreeSelect",on:{getValue:e.getMainDep}})],1)],1)],1)},n=[],s=(a("96cf"),a("1da1")),o=a("5530"),i=a("2f62"),c=a("86da"),l=a("7174"),u={name:"Department",components:{Modal:c["a"],DepTreeSelect:l["a"]},data:function(){return{deptId:"",userIds:[],form:this.$form.createForm(this),formItemLayout:{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}}},props:{},watch:{},created:function(){},mounted:function(){},computed:{},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])({onTranDep:"SysDepartment/onTranDep"})),{},{getMainDep:function(e){this.deptId=e},close:function(){this.form.resetFields(),this.$refs.depTreeSelect.clear()},show:function(){this.$refs.modal.show()},submit:function(){var e=this,t=this,a=this.form.getFieldsValue();a.deptId=this.deptId,this.form.setFieldsValue(a),this.form.validateFieldsAndScroll(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(r,n){var s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r){a.next=9;break}return s={userIds:t.userIds},s.deptId=n.deptId,a.next=5,e.onTranDep(s);case 5:o=a.sent,200==o.status&&(t.form.resetFields(),e.$message.success("修改成功"),e.$emit("tranDepSuccess"),e.$refs.modal.close()),a.next=10;break;case 9:e.pop.loading=!1;case 10:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}})},d=u,p=a("2877"),m=Object(p["a"])(d,r,n,!1,null,null,null);t["default"]=m.exports},d2b6:function(e,t,a){"use strict";var r=a("5fc1"),n=a.n(r);n.a},da6e:function(e,t,a){},e568:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{ref:"modal",attrs:{title:"重置密码",width:this.$config.modalWidth.small},on:{ok:e.okHandler}},[a("a-form",{attrs:{form:e.form,labelCol:{span:5},wrapperCol:{span:19}}},[a("a-form-item",{attrs:{label:"新密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入确认新密码"}],validateTrigger:"blur"}],expression:"[\n          'password',\n          {\n            rules: [{ required: true, message: '请输入确认新密码' }],\n            validateTrigger: 'blur',\n          },\n        ]"}],staticClass:"inputPassword",attrs:{autocomplete:"false",placeholder:"请输入新密码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-form-item",{attrs:{label:"确认新密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password1",{rules:[{required:!0,message:"请输入确认新密码"}],validateTrigger:"blur"}],expression:"[\n          'password1',\n          {\n            rules: [{ required: true, message: '请输入确认新密码' }],\n            validateTrigger: 'blur',\n          },\n        ]"}],staticClass:"inputPassword",attrs:{autocomplete:"false",placeholder:"请输入确认新密码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1)},n=[],s=a("5530"),o=a("2f62"),i=a("86da"),c={name:"ResetPasswordModal",components:{Modal:i["a"]},props:{},data:function(){return{formData:{},form:this.$form.createForm(this)}},methods:Object(s["a"])(Object(s["a"])({},Object(o["b"])({onResetPassword:"SysUser/onResetPassword"})),{},{show:function(){this.form.resetFields(),this.$refs.modal.show()},okHandler:function(){var e=this,t=this.form.validateFields;t((function(t,a){t||(a.password!==a.password1?e.$message.error("新密码和确认密码不匹配"):e.onResetPassword(Object(s["a"])(Object(s["a"])({},a),{},{userIds:e.formData.userId})).then((function(){e.$message.success("重置密码成功"),e.formData={},e.$refs.modal.close()})))}))}})},l=c,u=a("2877"),d=Object(u["a"])(l,r,n,!1,null,"3faaed59",null);t["default"]=d.exports}}]);