(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ab54099"],{"1d99":function(e,t,a){"use strict";var n=a("b775");t["a"]={reAlarmInfoList:function(e){return Object(n["a"])({url:"/manage-service/reAlarmInfo/getResultList",method:"POST",data:e})},reAlarmInfoDetail:function(e){return Object(n["a"])({url:"/manage-service/reAlarmInfo/getResultDetail?alarmId="+e.alarmId+"&type="+e.type,method:"POST"})},reAlarmInfoInfos:function(e){return Object(n["a"])({url:"/manage-service/reAlarmInfo/handleAlarmInfos?alarmIds="+e,method:"POST"})},reAlarmInfosaveHandleMsg:function(e){return Object(n["a"])({url:"/manage-service/reAlarmInfo/saveHandleMsg",method:"POST",data:e})},page:function(e){return Object(n["a"])({url:"/monitor-service/page",params:e,method:"GET"})},personList:function(e){return Object(n["a"])({url:"/monitor-service/personList?taskId="+e,method:"GET"})},singlePersonTrack:function(e){return Object(n["a"])({url:"/monitor-service/singlePersonTrack?taskPersonId="+e,method:"GET"})},trackResult:function(e){return Object(n["a"])({url:"/monitor-service/trackResult",method:"POST",data:e})},selectMonitorPerson:function(e){return Object(n["a"])({url:"/monitor-service/selectMonitorPerson?belongManagerId="+e.userId+"&currentPage="+e.currentPage+"&pageSize="+e.pageSize+"&likeField="+e.likeField,method:"GET"})},saveTask:function(e){return Object(n["a"])({url:"/monitor-service/saveTask",method:"POST",data:e})}}},"757b":function(e,t,a){},"8cf2":function(e,t,a){"use strict";var n=a("757b"),o=a.n(n);o.a},a44e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageView",[a("SplitLayout",[a("div",{staticClass:"header-top",attrs:{slot:"top"},slot:"top"},[a("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.iconShow,expression:"iconShow"}],attrs:{type:"menu-fold"},nativeOn:{click:function(t){return e.iconTable(1)}}}),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:!e.iconShow,expression:"!iconShow"}],attrs:{type:"menu-unfold"},nativeOn:{click:function(t){return e.iconTable(2)}}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.iconShow,expression:"iconShow"}],staticStyle:{display:"inline-block"}},[a("a-input-search",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"请输入任务名称",allowClear:""},on:{search:e.onSearch}}),a("OperationPermission",{attrs:{check:"privs.item1490020001"}},[a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.selectMonitorPerson}},[e._v("新建")])],1)],1)],1)]),a("a-modal",{attrs:{title:"添加查询任务",width:"60%",centered:""},on:{ok:e.addRenwu},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("a-col",{attrs:{span:6}},[e._v("任务名称")]),a("a-col",{attrs:{span:18}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.vo.taskName,callback:function(t){e.$set(e.vo,"taskName",t)},expression:"vo.taskName"}})],1)],1),a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("a-col",{attrs:{span:6}},[e._v("查询时间")]),a("a-col",{attrs:{span:18}},[a("a-range-picker",{attrs:{"show-time":""},model:{value:e.vo.selectTime,callback:function(t){e.$set(e.vo,"selectTime",t)},expression:"vo.selectTime"}},[a("template",{slot:"renderExtraFooter"},[e._v("extra footer")])],2)],1)],1),a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("a-col",{attrs:{span:6}},[e._v("查询人员")]),a("a-col",{attrs:{span:18}},[a("div",{staticStyle:{border:"1px solid #ddd","min-height":"30px",padding:"5px"}},e._l(e.vo.selectPersonVOList,(function(t,n){return a("a-tag",{key:n},[e._v(e._s(t.realName+" "+t.phone))])})),1)])],1),a("a-row",{staticStyle:{"margin-bottom":"10px"}},[a("a-col",{attrs:{span:24}},[a("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入"},on:{search:e.onSearchPer},model:{value:e.likeField,callback:function(t){e.likeField=t},expression:"likeField"}}),a("CustomTable",{ref:"table",attrs:{showAlert:!1,loading:e.loading,columns:e.columnsmodal,dataSource:e.selectMonitorPersonData,customRow:e.modalsetRow},on:{change:e.onTableChangeModal},scopedSlots:e._u([{key:"order",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"taskStatus",fn:function(t){return[e._v(" "+e._s(1==t?"查询中":2==t?"已完成":-1==t?"下发失败":"查询失败")+" ")]}}])})],1)],1)],1),a("div",{staticStyle:{background:"#fff"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.iconShow,expression:"iconShow"}],staticStyle:{width:"50%",display:"inline-block"}},[a("CustomTable",{directives:[{name:"show",rawName:"v-show",value:e.table1Show,expression:"table1Show"}],ref:"table",attrs:{showAlert:!1,loading:e.loading,columns:e.columns,dataSource:e.pageData,customRow:e.setRow},on:{change:e.onTableChange},scopedSlots:e._u([{key:"order",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"taskStatus",fn:function(t){return[e._v(" "+e._s(1==t?"查询中":2==t?"已完成":-1==t?"下发失败":"查询失败")+" ")]}}])}),a("CustomTable",{directives:[{name:"show",rawName:"v-show",value:e.table2Show,expression:"table2Show"}],ref:"table",attrs:{showAlert:!1,loading:e.loading,columns:e.columns2,dataSource:e.personListData,customRow:e.personListDatasetRow},scopedSlots:e._u([{key:"order",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"taskStatus",fn:function(t){return[e._v(" "+e._s(1==t?"查询中":2==t?"已完成":-1==t?"下发失败":"查询失败")+" ")]}}])})],1),a("div",{class:{mapWidth:0==e.iconShow},staticStyle:{width:"50%",height:"600px",float:"right"},attrs:{id:"map"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.table3Show,expression:"table3Show"}]},[a("a-row",[a("a-col",{attrs:{span:6}},[a("img",{attrs:{src:e.singlePersonTrackData.singlePersonInfo.avatar,alt:""}})]),a("a-col",{attrs:{span:18}},[a("a-row",[a("a-col",{attrs:{span:12}},[e._v(" 姓名："+e._s(e.singlePersonTrackData.singlePersonInfo.realName)+" ")]),a("a-col",{attrs:{span:12}},[e._v("手机号："+e._s(e.singlePersonTrackData.singlePersonInfo.phone))])],1),a("a-row",[a("a-col",{attrs:{span:12}},[e._v(" 身份证："+e._s(e.singlePersonTrackData.singlePersonInfo.identityCard)+" ")]),a("a-col",{attrs:{span:12}},[e._v(" 户籍地址："+e._s(e.singlePersonTrackData.singlePersonInfo.householdAddress)+" ")])],1),a("a-row",[a("a-col",{attrs:{span:24}},[e._v(" 执行时间："+e._s(e.singlePersonTrackData.singlePersonInfo.executionDate)+" ")])],1),a("a-row",[a("a-col",{attrs:{span:24}},[e._v(" 现居住地址："+e._s(e.singlePersonTrackData.singlePersonInfo.currentTown)+" ")])],1),a("a-row",[a("a-col",{attrs:{span:12}},[e._v(" 专职人员姓名："+e._s(e.singlePersonTrackData.singlePersonInfo.belongManagerName)+" ")]),a("a-col",{attrs:{span:12}},[e._v(" 手机号："+e._s(e.singlePersonTrackData.singlePersonInfo.belongManagerPhone)+" ")])],1)],1)],1),a("CustomTable",{ref:"table",attrs:{showAlert:!1,loading:e.loading,columns:e.columns3,dataSource:e.singlePersonTrackData.monitorTaskInfoList,customRow:e.personListDatasetRow},scopedSlots:e._u([{key:"order",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"taskStatus",fn:function(t){return[e._v(" "+e._s(1==t?"查询中":2==t?"已完成":-1==t?"下发失败":"查询失败")+" ")]}}])})],1)])],1)},o=[],s=(a("4160"),a("d81d"),a("159b"),a("5530")),r=a("c1df"),i=a.n(r),l=a("1d99"),c=a("bf11"),u=(a("310e"),a("cc33")),d=(a("5bc0"),a("a2c7")),h=a("5eee"),m=a("4cdf"),p=a("3e6b"),g=a("9c78"),f=a("480c"),w=a("f2f0"),v=a("5831"),S=a("f403"),b=a("6c77"),k=a("ce2c"),P=a("83a6"),T=a("8682"),I=a("256f"),_={components:{CustomTable:c["a"]},data:function(){var e=this;return{currentPage:1,pageSize:10,iconShow:!0,likeField:"",selectMonitorPersonData:"",arrPerson:[],modalVisible:!1,loading:!1,pageData:{},personListData:{},vo:{taskName:"",selectTime:"",selectPersonVOList:[]},singlePersonTrackData:{monitorTaskInfoList:[],singlePersonInfo:{realName:"",avatar:"",phone:"",identityCard:"",householdAddress:"",executionDate:"",currentTown:"",belongManagerName:"",belongManagerPhone:""}},table1Show:!0,table2Show:!1,table3Show:!1,formSearch:{userId:1},columnsmodal:[{title:"序号",dataIndex:"order",scopedSlots:{customRender:"order"},customRender:function(t,a,n){return"".concat((e.pageFilter.currentPage-1)*e.pageFilter.pageSize+(n+1))}},{title:"姓名",dataIndex:"realName"},{title:"手机号码",dataIndex:"phone"},{title:"身份证",dataIndex:"identityCard"},{title:"执行时间",dataIndex:"executionDate"},{title:"专职人员",dataIndex:"taskStatus"}],columns:[{title:"序号",dataIndex:"order",scopedSlots:{customRender:"order"},customRender:function(t,a,n){return"".concat((e.pageFilter.currentPage-1)*e.pageFilter.pageSize+(n+1))}},{title:"任务名称",dataIndex:"taskName",scopedSlots:{customRender:"type"}},{title:"查询时间",dataIndex:"selectBeginTime"},{title:"查询状态",dataIndex:"taskStatus",scopedSlots:{customRender:"taskStatus"}}],columns2:[{title:"序号",dataIndex:"order",scopedSlots:{customRender:"order"},customRender:function(t,a,n){return"".concat((e.pageFilter.currentPage-1)*e.pageFilter.pageSize+(n+1))}},{title:"姓名 ",dataIndex:"name"},{title:"手机号",dataIndex:"phone"},{title:"最新时间",dataIndex:"newTime"},{title:"最新位置",dataIndex:"newSite"}],columns3:[{title:"位置编号",dataIndex:"siteNumber"},{title:"时间 ",dataIndex:"trackTime"},{title:"经度",dataIndex:"longitude"},{title:"纬度",dataIndex:"latitude"},{title:"位置",dataIndex:"site"}],view:"",gisConstructor:{},map:{},pageFilter:{currentPage:1,pageSize:10}}},mounted:function(){this.page(),this.loadingMap()},methods:{iconTable:function(e){this.iconShow=1!=e},page:function(){var e=this;l["a"].page(this.pageFilter).then((function(t){e.pageData=t}))},onTableChange:function(e){this.pageFilter=Object(s["a"])(Object(s["a"])({},this.pageFilter),e),this.page()},onTableChangeModal:function(e){this.pageSize=e.pageSize,this.currentPage=e.currentPage,this.selectMonitorPerson()},onSearch:function(e){this.pageFilter.currentPage=1,this.pageFilter.taskName=e,this.page()},onSearchPer:function(){this.selectMonitorPerson()},addRenwu:function(){var e=this;this.vo.selectTime&&(this.vo.selectBeginTimeStr=i()(this.vo.selectTime[0]).format("YYYY-MM-DD HH:MM:SS"),this.vo.selectEndTimeStr=i()(this.vo.selectTime[1]).format("YYYY-MM-DD HH:MM:SS")),l["a"].saveTask(this.vo).then((function(t){e.modalVisible=!1,e.pageFilter.taskName="",e.page()}))},unique:function(e){for(var t=[e[0]],a=1;a<e.length;a++){for(var n=!1,o=0;o<t.length;o++)if(e[a].phone===t[o].phone){n=!0;break}n||t.push(e[a])}return t},modalsetRow:function(e){var t=this;return{on:{click:function(a){if(void 0==t.vo.selectPersonVOList||0==t.vo.selectPersonVOList.length)t.vo.selectPersonVOList.push(e);else{t.vo.selectPersonVOList.push(e);var n=t.vo.selectPersonVOList;t.vo.selectPersonVOList=t.unique(n)}}}}},setRow:function(e){var t=this;return{on:{click:function(a){l["a"].personList(e.id).then((function(e){t.personListData=e,t.table1Show=!1,t.table2Show=!0,t.getdata()}))}}}},personListDatasetRow:function(e){var t=this;return{on:{click:function(a){console.log(e),l["a"].singlePersonTrack(e.id).then((function(e){t.singlePersonTrackData=e,t.table1Show=!1,t.table2Show=!1,t.table3Show=!0}))}}}},selectMonitorPerson:function(){var e=this,t={currentPage:this.currentPage,userId:Object(u["f"])().userId,pageSize:this.pageSize,likeField:this.likeField};l["a"].selectMonitorPerson(t).then((function(t){e.selectMonitorPersonData=t,e.modalVisible=!0}))},loadingMap:function(){var e=this;this.view=new d["a"]({projection:"EPSG:4326",center:[110.321533,20.036168],zoom:12,minZoom:6}),this.map=new h["a"]({target:"map",view:this.view}),this.map.addLayer(new g["a"]({layers:this.layerData()})),this.map.on("click",(function(t){e.map.forEachFeatureAtPixel(t.pixel,(function(e){return e}))}))},layerData:function(){for(var e=Object(I["g"])("EPSG:4326"),t=(e.getExtent(),1.40625),a=[],n=[],o=0;o<28;o++)n[o]=o,a[o]=t/Math.pow(2,o);var s=[];return s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.PROPL_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.VEGPL_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.HYDPL_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.RESPL_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.RAILN_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.ROALN_ZW)})),s.push(new f["a"]({source:new w["a"](this.$globalConfig.mapConfig.PLAPT_ZW)})),s},getdata:function(){var e=[];this.personListData.forEach((function(t){t.monitorTaskInfoList.forEach((function(t,a){e.push([parseFloat(t.longitude),parseFloat(t.latitude)])}))}));var t=new v["a"];e.forEach((function(e){var a=new m["a"]({geometry:new S["a"](e)}),n=[new b["c"]({image:new k["a"]({fill:new P["a"]({color:"#3399CC"}),stroke:new T["a"]({color:"#ffffff",width:1.25}),radius:9})})];a.setStyle(n),t.addFeature(a)}));var a=new p["a"]({title:"equipment",source:t});this.map.addLayer(a)}}},x=_,y=(a("8cf2"),a("2877")),D=Object(y["a"])(x,n,o,!1,null,"2414b5f4",null);t["default"]=D.exports}}]);