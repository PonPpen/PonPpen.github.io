(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aca35ca4"],{"0a68":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("SplitLayout",[a("a-form-model",{ref:"formModal",attrs:{model:e.form,rules:e.rules}},[a("div",{staticClass:"message"},[a("h5",[e._v("推送内容")])]),a("a-form-model-item",{attrs:{label:"消息标题",prop:"title"}},[a("a-input",{attrs:{disabled:e.can_input,placeholder:"请输入"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("a-form-model-item",{attrs:{label:"一级分类",prop:"oneLevelTypeName"}},[a("a-select",{staticStyle:{width:"500px"},attrs:{disabled:e.can_input,placeholder:"请选择消息类型"},model:{value:e.form.oneLevelTypeName,callback:function(t){e.$set(e.form,"oneLevelTypeName",t)},expression:"form.oneLevelTypeName"}},[e._l(e.oneLevelTypeName,(function(t){return[a("a-select-option",{key:t.value,attrs:{value:t.name},nativeOn:{click:function(a){return e.setOneLevelType(t)}}},[e._v(e._s(t.name))])]}))],2)],1),a("a-form-model-item",{attrs:{label:"二级分类",prop:"twoLevelTypeName"}},[a("a-select",{staticStyle:{width:"500px"},attrs:{disabled:e.can_input,placeholder:"请选择消息类型"},model:{value:e.form.twoLevelTypeName,callback:function(t){e.$set(e.form,"twoLevelTypeName",t)},expression:"form.twoLevelTypeName"}},[e._l(e.twoLevelTypeName,(function(t){return[a("a-select-option",{key:t.value,attrs:{value:t.name},nativeOn:{click:function(a){return e.setTwoLevelType(t)}}},[e._v(e._s(t.name))])]}))],2)],1),a("a-form-model-item",{attrs:{label:"推送内容"}},[a("a",{on:{click:function(t){e.visible=!0}}},[e._v("选择模板")]),a("UEditor",{ref:"ueditor",staticClass:"editor",staticStyle:{width:"500px",height:"500px","z-index":"0"},attrs:{ToolbarsType:2,content:e.form.content,menuObj:e.menuObj}})],1),a("div",{staticClass:"message"},[a("h5",[e._v("推送设置")])]),a("a-form-model-item",{attrs:{label:"推送平台",prop:"pushPlatform"}},[a("a-select",{staticStyle:{width:"500px"},attrs:{disabled:e.can_input,placeholder:"选择平台"},on:{change:e.handleChange},model:{value:e.form.pushPlatform,callback:function(t){e.$set(e.form,"pushPlatform",t)},expression:"form.pushPlatform"}},[a("a-select-option",{attrs:{value:2}},[e._v("椰风送暖")]),a("a-select-option",{attrs:{value:1}},[e._v("智慧禁毒")])],1)],1),a("a-form-model-item",{attrs:{label:"推送对象",prop:"pushUserList"}},[a("ScopeApplication",{ref:"SelectIndex",attrs:{disabled:e.can_input,multipleChoice:!1,checkedDataType:e.checkedDataType,allCheckedList:e.pushUserList,width:500},on:{getRangeInfo:e.getRangeInfo},nativeOn:{click:function(t){return e.selectPlatform(t)}}})],1),a("a-form-model-item",{attrs:{label:"推送时间",prop:"pushWay"}},[a("a-radio-group",{attrs:{disabled:e.can_input},model:{value:e.form.pushWay,callback:function(t){e.$set(e.form,"pushWay",t)},expression:"form.pushWay"}},[a("a-radio",{attrs:{value:2}},[e._v(" 定时推送 ")]),a("a-radio",{attrs:{value:1}},[e._v(" 立即推送 ")])],1)],1),2===e.form.pushWay?a("a-form-model-item",{staticStyle:{"margin-left":"130px"},attrs:{disabled:e.can_input,prop:"startTime"}},[a("a-date-picker",{staticStyle:{width:"500px"},attrs:{"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",valueFormat:"YYYY-MM-DD HH:mm",placeholder:"请选择时间"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}})],1):e._e(),a("a-form-model-item",{attrs:{label:"推送方式",prop:"pushChannel"}},[a("a-checkbox-group",{attrs:{disabled:e.can_input},model:{value:e.form.pushChannel,callback:function(t){e.$set(e.form,"pushChannel",t)},expression:"form.pushChannel"}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-checkbox",{attrs:{value:2}},[e._v(" 短信 ")])],1),a("a-col",{attrs:{span:12}},[a("a-checkbox",{attrs:{value:3}},[e._v(" 站内 ")])],1)],1)],1)],1),a("a-form-model-item",{attrs:{label:"常提醒设置",prop:"isOftenRemind"}},[a("a-radio-group",{attrs:{disabled:e.can_input},model:{value:e.form.isOftenRemind,callback:function(t){e.$set(e.form,"isOftenRemind",t)},expression:"form.isOftenRemind"}},[a("a-radio",{attrs:{value:1}},[e._v(" 是 ")]),a("a-radio",{attrs:{value:2}},[e._v(" 否 ")])],1)],1),a("a-form-model-item",[e.can_input?a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]):a("a-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1),a("a-modal",{staticClass:"doc",attrs:{title:"请选择模板","confirm-loading":e.confirmLoading},on:{ok:function(t){e.visible=!1}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticStyle:{"vertical-align":"middle",display:"flex","flex-direction":"column"}},[a("span",{staticStyle:{"margin-left":"-130px"}},[e._v("请选择模板")]),a("a-select",{staticStyle:{width:"200px",margin:"0 auto"},model:{value:e.doc,callback:function(t){e.doc=t},expression:"doc"}},[e._l(e.docList,(function(t){return[a("a-select-option",{key:t.name,attrs:{value:t.name},nativeOn:{click:function(a){return e.change(t)}}},[e._v(e._s(t.name))])]}))],2)],1)])],1)},r=[],o=(a("a15b"),a("d81d"),a("13d5"),a("fb6a"),a("b0c0"),a("a9e3"),a("ac1f"),a("5319"),a("1276"),a("3835")),i=a("2909"),s=(a("96cf"),a("1da1")),c=a("5530"),u=a("0d21"),l=a("db90"),d=a("06c5"),m=a("3d8c");function f(e){return Object(u["a"])(e)||Object(l["a"])(e)||Object(d["a"])(e)||Object(m["a"])()}var p=a("ea07"),h=a("c443"),v=a("f45a"),g=a("2f62"),y=a("e96b"),b=a("ef6c"),T=a("cf45"),w=a("c1df"),_=a.n(w),D={name:"new_message",components:{UEditor:v["a"],ScopeApplication:y["a"]},computed:{can_input:function(){return"detail"==this.type}},provide:function(){return{reload:this.reload}},data:function(){var e=this,t=function(t,a,n){console.log(1144),""===a||null===a||void 0===a?n(new Error("请设置推送时间")):2===e.form.status&&Date.parse(e.oldStartTime)==Date.parse(a)&&Date.parse(e.oldStartTime)<new Date||Date.parse(a)<new Date?n(new Error("请准确设置推送时间。")):n()};return{form:{},rules:{pushChannel:[{required:!0,message:"请选择提交渠道"}],title:[{required:!0,message:"请输入标题"},{validator:T["p"]}],oneLevelTypeName:[{required:!0,message:"请选择一级消息分类"}],twoLevelTypeName:[{required:!0,message:"请选择二级消息分类"}],pushWay:[{required:!0,message:"请选择推送时间"}],pushUserList:[{required:!0,message:"请选择推送对象"}],isOftenRemind:[{required:!0,message:"请选择是否常提醒"}],pushPlatform:[{required:!0,message:"请选择推送渠道"}],pushContent:[{required:!0,message:"请输入推送内容"}],startTime:[{validator:t,trigger:"change"}]},type:"",oldStartTime:"",oneLevelTypeName:[],twoLevelTypeName:[],pushUserList:[],menuObj:{},confirmLoading:!1,area:"",doc:"",docList:[],visible:!1,regionOptions:b["regionData"],pushChannelTmp:[],selectLevelTypeFlag:!1,isRouterShow:!0,checkedDataType:[]}},watch:{area:function(e){var t=f(e),a=t[0],n=t[1],r=t.slice(2);r=r.join(","),this.form=Object(c["a"])(Object(c["a"])({},this.form),{},{province:a,city:n,area:r})}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.type=e.$route.query.type,!e.$store.state.typesNameDic.typeName.length){t.next=5;break}e.oneLevelTypeName=e.$store.state.typesNameDic.typeName,t.next=8;break;case 5:return t.next=7,e.get_typeName({majorKey:"newsType"});case 7:e.oneLevelTypeName=e.$store.state.typesNameDic.typeName;case 8:return e.requireDoc(),t.next=11,"edit"==e.type||"detail"==e.type;case 11:if(t.t0=t.sent,!t.t0){t.next=14;break}t.t0=e.id=e.$route.query.id;case 14:if(t.t1=t.t0,!t.t1){t.next=17;break}h["a"].get_diy_detail({id:e.$route.query.id}).then((function(t){console.log(t);t.province,t.city,t.area;var a=t.content,n=(t.id,t.pushChannel),r=t.pushPlatform,o=(t.title,t.oneLevelTypeName,t.twoLevelTypeName,t.remindWay);t.isPopUp,t.pushWay,t.isOftenRemind;e.form=t,e.form.pushPlatform=Number(r),e.form.remindWay=Number(o),e.$refs.SelectIndex.tenantName=Object(i["a"])(t.pushUserList).map((function(e){return{label:e.userName,id:e.userId}})),e.form.pushChannel=n.split(",").map((function(e){return 1*e})),e.pushChannelTmp=e.form.pushChannel,console.log(e.form),e.$refs.ueditor.message=a,e.oldStartTime=e.form.startTime,e.selectLevelTypeFlag=!0,e.setOneLevelType(e.oneLevelTypeName[e.form.oneLevelType-1])}));case 17:case"end":return t.stop()}}),t)})))()},methods:Object(c["a"])(Object(c["a"])({},Object(g["b"])({get_typeName:"typesNameDic/on_get_typeName"})),{},{getRangeInfo:function(e){console.log(e);var t=[],a="";e&&e.length>0&&(a=e[0].type,e[0].dataObj.reduce((function(e,a){t.push({userId:a.objId,userName:a.name,phone:a.phone?a.phone:""})}),[])),this.form.userType=a,this.form.pushUserList=t,console.log(this.form)},requireDoc:function(){var e=this,t={type:"1"};Object(p["e"])(t).then((function(t){console.log(t),e.docList=t.data}))},change:function(e){var t=this;this.confirmLoading=!0,console.log(e),Object(p["c"])(e.id).then((function(e){t.confirmLoading=!1,t.$refs.ueditor.message=e.data.content,console.log(e,t.form.content)}))},setOneLevelType:function(e){var t=this;console.log(e),this.form.oneLevelType=e.value,h["a"].get_typeName({majorKey:e.majorKey}).then((function(e){if(!t.selectLevelTypeFlag){var a=Object(o["a"])(e[0].name,1),n=a[0];t.form=Object(c["a"])(Object(c["a"])({},t.form),{},{twoLevelTypeName:n}),t.form.twoLevelTypeName=e[0].name,t.form.twoLevelType=e[0].value}t.selectLevelTypeFlag=!1,t.twoLevelTypeName=e}))},setTwoLevelType:function(e){this.form.twoLevelType=e.value},save:function(){var e=this;1===this.form.pushWay&&(this.form.startTime=_()(new Date).format("YYYY-MM-DD HH:mm")),this.$refs.formModal.validate((function(t){t&&("edit"==e.type&&e.editMessage(),"add"==e.type&&e.addMessage())}))},addMessage:function(){var e=this;this.form.content=this.$refs.ueditor.message,this.form.pushChannel=this.form.pushChannel.join(","),this.form.content=this.form.content.replace(/<\/?.+?>/g,"").replace(/&nbsp;/gi,""),h["a"].new_diy_message(this.form).then((function(t){t&&(e.$message.success("提交成功"),e.$router.go(-1))}))},editMessage:function(){var e=this;this.form.content=this.$refs.ueditor.message,this.form.pushChannel=this.pushChannelTmp.join(","),console.log(this.form),h["a"].edit_diy_message(this.form).then((function(t){t&&(e.$message.success("提交成功"),e.$router.go(-1))}))},handleChange:function(e){2===e?this.checkedDataType=[5]:1===e&&(this.checkedDataType=[1,2,3,4])},reload:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isRouterShow=!1,t.next=3,e.$nextTick();case 3:e.isRouterShow=!0;case 4:case"end":return t.stop()}}),t)})))()},selectPlatform:function(){this.checkedDataType&&this.checkedDataType.length<1&&this.$message.warning("请先选择推送平台")}})},x=D,L=(a("89fc"),a("2877")),O=Object(L["a"])(x,n,r,!1,null,"bbc61aca",null);t["default"]=O.exports},"0d21":function(e,t,a){"use strict";function n(e){if(Array.isArray(e))return e}a.d(t,"a",(function(){return n}))},"0d3a":function(e,t,a){},3835:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("0d21");a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");function r(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var a=[],n=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0)if(a.push(i.value),t&&a.length===t)break}catch(c){r=!0,o=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(r)throw o}}return a}}var o=a("06c5"),i=a("3d8c");function s(e,t){return Object(n["a"])(e)||r(e,t)||Object(o["a"])(e,t)||Object(i["a"])()}},"3d8c":function(e,t,a){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}a.d(t,"a",(function(){return n}))},"89fc":function(e,t,a){"use strict";var n=a("0d3a"),r=a.n(n);r.a},cf45:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"l",(function(){return r})),a.d(t,"f",(function(){return o})),a.d(t,"g",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"j",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"k",(function(){return l})),a.d(t,"m",(function(){return d})),a.d(t,"o",(function(){return m})),a.d(t,"p",(function(){return f})),a.d(t,"n",(function(){return p})),a.d(t,"q",(function(){return h})),a.d(t,"c",(function(){return v})),a.d(t,"b",(function(){return g})),a.d(t,"d",(function(){return y})),a.d(t,"e",(function(){return b}));a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276");function n(e,t,a){var n=new RegExp(/^((\+?86)|(\(\+86\)))?1[3456789]\d{9}$/);t&&!n.test(t)?a("当前联系方式不符合规范!"):a()}function r(e,t,a){var n=new RegExp(/^([0-9]{3,4}-)?[0-9]{7,8}$/);t&&!n.test(t)?a("当前联系方式不符合规范!"):a()}function o(e,t,a){var n=new RegExp(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/);t&&!n.test(t)?a("当前身份证不符合规范!"):a()}function i(e,t,a){var n=new RegExp(/^[\u0391-\uFFE5A-Za-z]+$/);t&&!n.test(t)?a("姓名不符合规范，只允许输入汉字和英文!"):t&&t.length<2?a("姓名长度不能小于1个字符"):t&&t.length>20?a("输入长度不能大于20个字符"):a()}function s(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{}]){1,20}$/);t&&!n.test(t)?a("现在居住地不符合规范，包含中英文字母数字或下划线!"):t&&t.length<2?a("现在居住地长度不能小于1个字符"):a()}function c(e,t,a){var n=new RegExp(/^[\u0391-\uFFE5A-Za-z]+$/);t&&!n.test(t)?a("毕业院校不符合规范，只允许输入汉字和英文!"):t&&t.length<2?a("毕业院校长度不能小于1个字符"):a()}function u(e,t,a){var n=new RegExp(/^[\u0391-\uFFE5A-Za-z]+$/);t&&!n.test(t)?a("专业不符合规范，只允许输入汉字和英文!"):t&&t.length<2?a("专业长度不能小于1个字符"):a()}function l(e,t,a){var n=new RegExp(/^([a-zA-Z0-9_-]){1,999}$/);t&&!n.test(t)?a("输入不规范，只允许输入字母、数字以及符号_-"):t&&t.length<2?a("输入长度不能小于1个字符"):a()}function d(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{}]){1,999}$/);t&&!n.test(t)?a("输入不规范，不允许输入特殊字符！"):t&&t.length<2?a("输入长度不能小于1个字符"):a()}function m(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{},.，。/+]){1,999}$/);t&&!n.test(t)?a("输入不规范，不允许输入特殊字符！"):t&&t.length<2?a("输入长度不能小于1个字符"):t&&t.length>20?a("输入长度不能大于20个字符"):a()}function f(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{},.，。/+]){1,999}$/);t&&!n.test(t)?a("输入不规范，不允许输入特殊字符！"):t&&t.length<2?a("输入长度不能小于1个字符"):t&&t.length>50?a("输入长度不能大于50个字符"):a()}function p(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{},.，。/+]){1,999}$/);t&&!n.test(t)?a("输入不规范，不允许输入特殊字符！"):t&&t.length<2?a("输入长度不能小于1个字符"):t&&t.length>100?a("输入长度不能大于100个字符"):a()}function h(e,t,a){var n=new RegExp(/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|[a-zA-Z0-9_-]|[()（）{},.，。/+]){1,999}$/);t&&!n.test(t)?a("输入不规范，不允许输入特殊字符！"):t&&t.length<2?a("输入长度不能小于1个字符"):t&&t.length>500?a("输入长度不能大于500个字符"):a()}function v(e,t){if(""!=e&&""!=t&&void 0!=e&&void 0!=t&&null!=e&&null!=t){var a=e.split("-"),n=t.split("-"),r=a[0]+"/"+a[1]+"/"+a[2],o=n[0]+"/"+n[1]+"/"+n[2];return r>=o}}function g(e,t){var a=new Date,n="";return n=e.replace(/-/g,"/"),n=new Date(n),n.valueOf()>a.valueOf()}function y(e,t,a){return Date.parse(e)>=Date.parse(t)||Date.parse(e)>=Date.parse(a)||Date.parse(t)>Date.parse(a)||Date.parse(a)==Date.parse(t)&&Date.parse(a)<Date.parse(e)||Date.parse(a)==Date.parse(t)&&Date.parse(t)<Date.parse(e)||Date.parse(a)>Date.parse(e)&&Date.parse(a)<Date.parse(t)}function b(e,t){var a=Date.parse(e),n=Date.parse(t);if(a>n)return 0;if(a==n)return 1;var r=(n-a)/864e5;return r}},ea07:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return d}));var n=a("a27e"),r={docCreate:"/doc-service/doc/create",docDetail:"/doc-service/doc/detail",docIsDefault:"/doc-service/doc/isDefault",docPage:"/doc-service/doc/page",docUpdate:"/doc-service/doc/update",docBusinessField:"/doc-service/doc/businessField",docList:"/doc-service/doc/list"};function o(e){return Object(n["a"])({url:r.docCreate,method:"POST",data:e})}function i(e){return Object(n["a"])({url:r.docDetail+"/".concat(e),method:"GET"})}function s(e){return Object(n["a"])({url:r.docIsDefault,method:"PUT",data:e})}function c(e){return Object(n["a"])({url:r.docPage,method:"POST",data:e})}function u(e){return Object(n["a"])({url:r.docUpdate,method:"PUT",data:e})}function l(e){return Object(n["a"])({url:r.docBusinessField,method:"GET"})}function d(e){return Object(n["a"])({url:r.docList,method:"POST",data:e})}}}]);